
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam to I/O for Women 2021 - Code Jam to I/O for Women</h3><h1>Introductions Organization</h1><h3>Problem</h3>
<p>
  After Apricot Rules LLC went through a reorganization, a new large team was formed containing
  $$$\mathbf{M}$$$ managers and $$$\mathbf{N}$$$ non-managers. Since many people within the team do not
  know each other, a number of introduction sessions are to be scheduled.
  We know exactly which pairs of members already know each other.
</p><p>
  The introduction sessions are organized into time slots that take $$$1$$$ minute.
  The first time slot starts at 8:00 AM and ends at 8:01 AM.
  The $$$i$$$-th time slot starts $$$i-1$$$ minutes after 8:00 AM
  and ends $$$i$$$ minutes after 8:00 AM.
  During each time slot, there can be one or more introduction sessions.
  A team member can be assigned to at most one introduction session per time slot. Each
  introduction session must have exactly three members: an assigned manager $$$a$$$ who must
  be a manager and two others $$$b$$$ and $$$c$$$ who can be managers or
  non-managers. The assigned manager $$$a$$$ must already know $$$b$$$ and $$$c$$$ for the
  session to be scheduled. After the introduction session, $$$b$$$ and $$$c$$$
  are considered to know each other too. If $$$b$$$ and/or $$$c$$$ are managers,
  either of them can be the assigned manager of a future introduction session that includes
  both.
</p><p>
  For some pairs of people in the team, we want to know the shortest time
  that is needed for them to finally know each other, or whether it is
  impossible for that to happen through the described process. If two people know each
  other before any introduction sessions happen, we define that shortest
  time to be $$$0$$$ minutes.
</p><p>
  Even though we are interested in multiple pairs of people, we are
  considering the situations independently. That is, the minimum time for each
  pair can depend on a specific organization of the introduction that is particular
  to that pair only.
</p>

<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, $$$\mathbf{T}$$$.
  $$$\mathbf{T}$$$ test cases follow. Each test case begins with a line containing
  three integers $$$\mathbf{M}$$$, $$$\mathbf{N}$$$, and $$$\mathbf{P}$$$: the number of managers on the new team, the
  number of non-managers on the new team, and the number of pairs of team members we are
  going to ask about, respectively. Managers are numbered from 1 through $$$\mathbf{M}$$$ and
  non-managers are numbered from $$$\mathbf{M} + 1$$$ through $$$\mathbf{M} + \mathbf{N}$$$. Then,
  $$$\mathbf{M} + \mathbf{N}$$$ lines follow with $$$\mathbf{M} + \mathbf{N}$$$ characters each.
  The j-th character on the i-th of these lines $$$\mathbf{C_{i,j}}$$$ is
  <code>Y</code> if team members $$$i$$$ and $$$j$$$ know each other before the introduction
  process starts, and <code>N</code> otherwise. Then, there are $$$\mathbf{P}$$$ more lines; the $$$k$$$-th
  of which contains a pair of integers $$$\mathbf{A_k}$$$ and
  $$$\mathbf{B_k}$$$ each, representing the team member numbers of the $$$k$$$-th pair we
  are interested in.
</p>

<h3>Output</h3>
<p>
  For each test case, output one line containing
  <code>Case #$$$x$$$: $$$y_1\ y_2\ y_3 \cdots y_\mathbf{P}$$$</code>,
  where $$$x$$$ is the test case number (starting from 1) and
  $$$y_i$$$ is $$$-1$$$ if team members $$$\mathbf{A_k}$$$
  and $$$\mathbf{B_k}$$$ cannot get to know each other, or the shortest amount
  of time (in minutes) since the process starts until they do.
</p>

<h3>Limits</h3>
<p>
Memory limit: 1 GB.<br/>

$$$1 \le \mathbf{T} \le 100$$$.<br/>
$$$\mathbf{C_{i,j}}$$$ is either uppercase <code>Y</code> or uppercase
<code>N</code>, for all $$$i, j$$$. <br/>
$$$\mathbf{C_{i,j}}$$$ = $$$\mathbf{C_{j,i}}$$$, for all $$$i, j$$$. <br/>
$$$\mathbf{C_{i,i}}$$$ = <code>Y</code>, for all $$$i$$$.
  (Team members know themselves.)<br/>
$$$1 \le \mathbf{A_k} \lt \mathbf{B_k} \le \mathbf{M} + \mathbf{N}$$$, for all $$$k$$$.<br/>
$$$(\mathbf{A_k}, \mathbf{B_k}) \neq (\mathbf{A_\ell}, \mathbf{B_\ell})$$$, for all $$$k &ne; \ell$$$.
    (No pair of team members is asked about twice.)<br/>
</p>

<h4>Test Set 1 (Visible Verdict)</h4>
<p>
Time limit: 20 seconds.<br/>

$$$1 \le \mathbf{M} \le 3$$$.<br/>
$$$1 \le \mathbf{N} \le 2$$$.<br/>
$$$1 \le \mathbf{P} \le 3$$$.<br/>
</p>

<h4>Test Set 2 (Hidden Verdict)</h4>
<p>
Time limit: 40 seconds.<br/>

$$$1 \le \mathbf{M} \le 50$$$.<br/>
$$$1 \le \mathbf{N} \le 50$$$.<br/>
$$$1 \le \mathbf{P} \le 100$$$.<br/>
</p>


  <h3>Sample</h3>
  <i>
    Note: there are additional samples that are not run on submissions down below.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="introductions_organization_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">3
2 2 3
YYYY
YYNN
YNYN
YNNY
2 3
2 4
1 4
3 2 2
YYYNN
YYNYN
YNYNY
NYNYN
NNYNY
2 5
4 5
1 1 1
YN
NY
1 2
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="introductions_organization_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 1 1 0
Case #2: 2 3
Case #3: -1
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  In Sample Case #1, manager $$$1$$$ knows everybody else at the start, and there are
  no other pairs of people that know each other. Therefore, any pair that includes manager $$$1$$$
  has $$$0$$$ as a result, since they know each other from the start. On the
  other hand, for any pair that does not include manager $$$1$$$, the two people do
  not know each other from the start, but can be introduced during the first
  time slot by manager $$$1$$$. Notice that the scenarios for the first two pairs considered
  independently.
</p><p>
  In Sample Case #2, manager $$$2$$$ and non-manager $$$5$$$ do not know each other, nor do
  they know anyone who knows both of them, so the minimum time for them to be
  introduced is at least $$$2$$$ minutes. One way for them to be introduced after
  exactly 2 minutes is for manager $$$3$$$ to introduce manager $$$1$$$ and non-manager $$$5$$$
  during the first time slot, after which manager $$$1$$$ can introduce manager $$$2$$$ and
  non-manager $$$5$$$ in the second time slot. For the second pair, we can start the same way to
  introduce manager $$$2$$$ and non-manager $$$5$$$ in 2 minutes and then, manager $$$2$$$ can
  introduce non-managers $$$4$$$ and $$$5$$$ in the third time slot, so $$$3$$$ minutes is an upper
  bound for introducing the pair of $$$4$$$ and $$$5$$$. It is impossible to do this quicker.
</p><p>
  In Sample Case #3, neither person in the new team knows the other, so no
  introductions are possible.
</p>


  <br/>
  <h3>Additional Sample - Test Set 2</h3>
  <i>
    The following additional sample fits the limits of Test Set 2. It will not
    be run against your submitted solutions.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="introductions_organization_sample_ts2_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_1">1
5 1 1
YYNNNN
YYYNNN
NYYYNN
NNYYYN
NNNYYY
NNNNYY
1 6
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="introductions_organization_sample_ts2_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_1">Case #1: 3
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  In this additional Sample Case, manager $$$2$$$ can introduce managers $$$1$$$ and $$$3$$$ in the
  first time slot, while at the same time manager $$$5$$$ can introduce manager $$$4$$$ and
  non-manager $$$6$$$. Then, manager $$$3$$$ can introduce managers $$$1$$$ and $$$4$$$ in
  the second time slot, and finally manager $$$4$$$ can introduce manager $$$1$$$ and non-manager
  $$$6$$$ in the third time slot.
</p>

    </div>
  </body>
</html>
