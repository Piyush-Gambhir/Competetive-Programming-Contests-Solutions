
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam to I/O for Women 2021 - Code Jam to I/O for Women</h3><h1>Analysis: Introductions Organization</h1><h3>Test Set 1</h3>
<p>
  In the first Test Set, the number of people in a new team is so small that we can
  use brute force. Even in the worst case, we only have five people: three
  managers and two non-managers. Since an introduction ties up three people,
  at most one introduction can take place in each minute. Moreover, there are
  only $$$\binom{3}{1}\times\binom{4}{2}=18$$$ possible groups of an
  introducing manager plus two other people, and only some of these will meet
  the conditions needed for an introduction: the introducing manager must know
  the other two people, and the other two people must not know each other (or
  else there would be no point in introducing them).
</p><p>
  We can use an exhaustive search to explore all ways of performing an
  introduction each minute until our target people are acquainted, or until we
  run out of valid introductions to make, and then return the smallest number
  of introductions we saw in a valid answer (or $$$-1$$$ if there is no
  answer). The bounds on the number of possible introductions and on the size
  of the answer (it cannot exceed $$$3$$$ in this test set) ensure that the space to
  explore is small, and so our solution will run very quickly.
</p>
<h3>Test Set 2</h3>
<p>
  To solve Test Set 2 we can model the problem as a
  <a href="https://en.wikipedia.org/wiki/Graph_(discrete_mathematics)" target="_blank">graph</a>.
  Every person in the team is a node, and we connect two different nodes with an edge
  if the represented people know each other when the team was formed.
  The key insight to solve this test set is to realize that an introduction
  changes the state from graph $$$G$$$ to a graph $$$H$$$ that is $$$G$$$ with one extra edge,
  and the extra edge directly connects two nodes that are connected in $$$G$$$
  by a <a href="https://en.wikipedia.org/wiki/Path_(graph_theory)" target="_blank">path</a>
  of length $$$2$$$ with an intermediate node that is a manager. Let $$$D_G(v,w)$$$
  be the distance in $$$G$$$ between nodes $$$v$$$ and $$$w$$$ considering just paths that
  only use managers as intermediate nodes. In what follows, when we say
  path or distance, we refer to those terms with the restriction of only
  using managers as intermediate nodes.
</p><p>
  Following the reasoning in the previous paragraph,
  $$$D_{G}(v,w)-1 \ge D_{H}(v,w)$$$ &mdash; that is, after an introduction,
  the distance between two nodes decreases by at most $$$1$$$. Moreover, if
  $$$D_{G}(v,w) \gt 1$$$ &mdash; that is, $$$v$$$ and $$$w$$$ do not know each other &mdash;
  and there is a path of managers between them, there is always a way to make an introduction such
  that the resulting $$$H$$$ has $$$D_{H}(v,w)=D_{G}(v,w)-1$$$. Let
  <code>$$$[v = x_0, x_1, x_2, \dots, x_{D_{G}(v,w)-1}, x_{D_{G}(v,w)} = w]$$$</code>
  be a minimum path that between $$$v$$$ and $$$w$$$ in $$$G$$$. Since $$$v$$$ and $$$w$$$ do not
  know each other, $$$x_1$$$ is neither of them, and therefore
  an intermediate step in the path, so $$$x_1$$$ is a manager.
  If $$$x_1$$$ introduces $$$v = x_0$$$ and $$$x_2$$$, the
  path <code>$$$[v = x_0, x_2, \dots, x_{D_{G}(v,w)-1}, x_{D_{G}(v,w)} = w]$$$</code>
  of length $$$D_{G}(v,w)-1$$$ is formed in the resulting $$$H$$$, so
  $$$D_{H}(v,w) = D_{G}(v,w)-1$$$.
</p><p>
  The goal of the problem is to use introductions to reduce the distance between
  a given pair of nodes $$$v$$$ and $$$w$$$ to $$$1$$$ (the minimum possible distance).
  So, if we could only do one introduction at a time, the answer would be exactly
  $$$D_{G_0}(v,w)$$$ in the initial graph $$$G_0$$$.
  Since time considerations don't change whether
  it is possible for $$$v$$$ and $$$w$$$ to meet, we can already say that $$$v$$$ and $$$w$$$ can
  meet if and only if there is a path connecting them in the initial graph.
</p><p>
  Let us now consider simultaneous introductions.
  Let $$$G_0, G_1, \dots, G_k$$$ be a
  list of graphs where $$$G_i$$$ models the state of the team at time $$$i$$$
  in an optimal way to make $$$v$$$ and $$$w$$$ meet (meaning $$$k$$$ is the answer for this pair).
  $$$G_0$$$ is the original team and $$$v$$$ and $$$w$$$ are connected directly by an
  edge only in $$$G_k$$$. For convenience, let $$$D_i = D_{G_i}(v, w)$$$.
  We can bound $$$D_{i + 1}$$$ in terms of $$$D_i$$$ as follows:
  each edge $$$(x, y)$$$ on $$$G_{i + 1}$$$ either exists in $$$G_i$$$ or
  comes from an introduction that happens between minutes $$$i$$$ and $$$i + 1$$$, meaning
  there is a path of length $$$2$$$ $$$[x, m, y]$$$ in $$$G_i$$$ where $$$m$$$ is a manager.
  Now fix $$$i$$$ and consider the path <code>$$$[v = x_0, x_1, \dots, x_{D_{i+1} - 1}, x_{D_{i+1}}
  = w]$$$</code>
  between $$$v$$$ and $$$w$$$ in $$$G_{i + 1}$$$. Consecutive edges share
  a person, so at most one of each pair can come from an introduction
  and the other one must exist in $$$G_i$$$. This gives us a
  bound $$$D_i \le D_{i+1} + \lceil(D_{i+1} / 2)\rceil$$$.
  Let us show that this bound is tight and always reachable:
  if we are at state $$$G_i$$$, and $$$D_i \gt 1$$$,
  we can take a minimum path <code>$$$[v = y_0, y_1, \dots,
  y_{D_{i} - 1}, y_{D_i} = w]$$$</code>
  between $$$v$$$ and $$$w$$$ in $$$G_i$$$ and have $$$y_{3j + 1}$$$
  to introduce $$$y_{3j}$$$ and $$$y_{3j + 2}$$$ for each $$$j$$$ between
  $$$0$$$ and $$$\lceil((D_i - 2) / 3)\rceil$$$. Those introductions at minute $$$i$$$
  yield $$$D_{i + 1} = D_i - \lceil((D_i - 2) / 3)\rceil$$$ and
  make exactly $$$\lceil(D_{i + 1})\rceil$$$ edges in $$$G_{i+1}$$$ come from an
  introduction.
</p><p>
  Given all the theory above, the answer for a given pair $$$v$$$ and $$$w$$$ for which
  $$$D_{G_0}(v, w)$$$ is undefined (that is, they are not connected)
  is impossible, and is otherwise
  $$$f(D_{G_0}(v, w))$$$ where $$$f(x)$$$ is the number of steps it takes for
  $$$x := x - \lceil((x - 1) / 3)\rceil$$$ to reach $$$x = 1$$$. Notice that it takes a
  logarithmic number of steps to reach $$$1$$$, so we can just calculate $$$f$$$
  on demand, or we can memoize all the needed values (for $$$x$$$ between
  $$$1$$$ and $$$\mathbf{N}$$$). Most shortest-path algorithms can be modified slightly
  to calculate the distance $$$D_0$$$ considering only managers
  as intermediate nodes as above, but the simplest must be
  <a href="https://en.wikipedia.org/wiki/Floyd%E2%80%93Warshall_algorithm" target="_blank">Floyd-Warshall</a>.
  Floyd-Warshall computes the shortest paths between every pair of nodes
  by considering each possible intermediate node in its outermost loop. So,
  simply restricting that loop to iterate over managers (up to $$$\mathbf{M}$$$ instead
  of $$$\mathbf{M}$$$+$$$\mathbf{N}$$$) is enough to calculate, in time
  $$$O(\mathbf{M} \times (\mathbf{N}+\mathbf{M})^2)$$$, the distance $$$D_{G_0}$$$
  for every pair of nodes. After running Floyd-Warshall and memoizing $$$f$$$ once, we can
  get the answer for every pair in constant time, so the algorithm takes
  $$$O(\mathbf{M} \times (\mathbf{M}+\mathbf{N})^2 + \mathbf{P})$$$ time overall.
</p>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>


    </div>
  </body>
</html>
