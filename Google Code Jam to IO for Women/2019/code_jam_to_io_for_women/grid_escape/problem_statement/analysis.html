
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam to I/O for Women 2019 - Code Jam to I/O for Women</h3><h1>Analysis: Grid Escape</h1><h3>Test set 1</h3>
<p>
  In the first test set, there can be at most 8 rooms in the grid. Each room
  can have its working exit in any one of the four directions, so we can use
  brute force to check all 4<sup>8</sup> possible ways to choose the 8
  working exits, and see how many players escape from each possible layout.
  Either we will find a solution, or we will show that the case is
  <code>IMPOSSIBLE</code>.
</p>
<h3>Test set 2</h3>
<p>
  In the second test set, we can no longer get away with an exhaustive
  approach! However, since we have some freedom in designing the grid, it's
  worth looking for a constructive solution.
</p><p>
  If <b>R</b> = <b>C</b> = 1, then <b>K</b> = 0 is impossible, and any
  solution works for <b>K</b> = 1. Otherwise, imagine drawing a "snaking"
  path through all of the rooms of the grid, choosing our working doors to
  allow us to follow this path. We start in the northwesternmost cell of the
  grid, and move eastward through rooms until we reach the northeasternmost
  cell. (If <b>C</b> = 1, we will already be there and so we will not need to
  move.) Then we make one move south, and if we have not exited the grid, we
  move westward through rooms until we reach a cell on the western border.
  Then we make one more move south (if possible), and then move eastward, and
  so on, until one of our moves to the south exits the grid.
</p><p>
  (By the way, a more obscure term for this type of winding path is
  <a href="https://en.wikipedia.org/wiki/Boustrophedon"><i>boustrophedon</i></a>,
  which derives from a way to direct oxen when plowing a field. Algorithms
  have been useful for a very long time!)
</p><p>
  Notice that all of the players can escape along our path, no matter where
  they start. Now consider choosing some room along the path and "reversing"
  its working door &mdash; that is, choosing the door that opens onto the
  previous room on the path. Then every player who starts in that room or a
  room earlier than it along the path cannot escape &mdash; they will be
  trapped in an infinite loop! Every other player will still be able to escape
  just as before.
</p><p>
  Since we can choose any room along the path, we can allow any desired number
  of players to escape... well, <i>almost</i> any number. If we try to use the
  above strategy to allow all but one of the players to escape, it breaks down
  because the very first room (where that player is) has no "previous room on
  the path".
</p><p>
  In fact, we can never allow all but one of the players to escape. Consider
  the room with the one player who we want to prevent from escaping. One of
  their doors has to work, and it cannot open onto the outside world, so it
  must open onto another room. But that means that our player will share the
  fate of the player in that other room &mdash; either they will both be able
  to escape, or neither will.
</p><p>
  So, if <b>K</b> = <b>R</b> &times; <b>C</b> - 1, the case is
  <code>IMPOSSIBLE</code>, and for any other case, the above construction gets
  us our answer. If <b>K</b> = <b>R</b> &times; <b>C</b>, we do not modify any
  of the path’s doors; otherwise, to allow exactly <b>K</b> of the players to
  escape, we "reverse" the door in the (<b>K</b>+1)-th-from-last room of the
  path.
</p><p>
  Many other approaches are possible. For example, we can design around the
  target number of players who cannot escape. As long as that number is at
  least two, we can create a "nucleus" of the trap in the upper left corner of
  the grid: either an <code>E</code> room to the west of a <code>W</code> room,
  or an <code>S</code> room to the north of an <code>N</code> room, depending
  on our given dimensions. Then we can turn cells sharing rows with the
  nucleus into <code>W</code>s, cells sharing columns with the nucleus into
  <code>N</code>s, and other cells (scanning top-to-bottom, then left-to-right)
  into <code>W</code>s until our set of trapped rooms is large enough. The
  remaining rooms can safely be filled with <code>S</code>. Alternatively,
  we can use <a href="https://en.wikipedia.org/wiki/Flood_fill">flood fill</a>
  to extend the sink.
</p>

    </div>
  </body>
</html>
