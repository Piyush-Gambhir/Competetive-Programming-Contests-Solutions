
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Kick Start 2019 - Round E</h3><h1>Analysis: Street Checkers</h1><h3>Test set 1 (Visible)</h3>
<p>
Let's rephrase the problem into counting the number of values X within the range [<b>L</b>, <b>R</b>]
that satisfies |(# of odd divisors) - (# of even divisors)| &le; 2.
</p>
<p>
To solve this problem under the constraint that <b>R</b> &lt; 10<sup>6</sup>. We can simply
preprocesses each X between 1 and 10<sup>6</sup> whether X is
interesting or not. To find whether X is interesting, we can apply any O(&radic;X)
time algorithm finding out all divisors of X. After storing the result for each X, we
  build a prefix sum array <b>F</b> storing for counts. Thus, each query can be answered by computing
  <b>F</b>[<b>R</b>] - <b>F</b>[<b>L</b>-1] in constant time.
  The total time complexity would then be O(<b>R<sub>max</sub></b>&radic;<b>R<sub>max</sub></b> + <b>T</b>),
  which suffices to pass the first test set.
</p>
<h3>Test set 2 (Hidden)</h3>
<p>
We need a slightly sophisticated observation here. The intuition comes from observing that any
divisor to an odd integer is still odd. For any integer X we can extract all power of 2 factors
and rewrite as X=<b>A</b>*2<sup>X</sup>, where <b>A</b> is an odd integer and X is a
non-negative integer.
</p>
<p>
Now, we can partition all divisors to X into sets of divisors leading with each odd divisors
<b>d<sub>1</sub></b>, <b>d<sub>2</sub></b>, ..., <b>d<sub>k</sub></b> of <b>A</b>:
</p>
<p>
  <blockquote>
    {<b>d<sub>1</sub></b>, <b>d<sub>1</sub></b>*2, <b>d<sub>1</sub></b>*2<sup>2</sup>, ...,
  <b>d<sub>1</sub></b>*2<sup>X</sup>},<br />
  {<b>d<sub>2</sub></b>, <b>d<sub>2</sub></b>*2, <b>d<sub>2</sub></b>*2<sup>2</sup>, ...,
  <b>d<sub>2</sub></b>*2<sup>X</sup>},<br />
  ...<br />
  {<b>d<sub>k</sub></b>, <b>d<sub>k</sub></b>*2, <b>d<sub>k</sub></b>*2<sup>2</sup>, ...,
  <b>d<sub>k</sub></b>*2<sup>X</sup>}.
  </blockquote>
</p>
<p>
  By looking at the above diagram we can infer that X has X odd divisors and
  X*X even divisors. The criteria to a number being interesting is now equivalent to
  |X*(X-1)| &le; 2.
</p>
<p>
  There are only a few cases of (X, X) pairs that satisfies the above expression:
</p>
<p>
  <ul>
  <li>Case 1: X=0, X=1 or 2.</li>
  <li>Case 2: X=1, X can be any value.</li>
  <li>Case 3: X=2, X=1 or 2.</li>
  <li>Case 4: X=3, X=1.</li>
  </ul>
</p>
<p>
So, what we really need to do here is to count the number of X's in the range [<b>L</b>, <b>R</b>]
satisfying each case.
</p>
<p>
  Case 1 implies that X=1 or a odd prime. One can count the number of primes within range
  [<b>L</b>, <b>R</b>] using <a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">Sieve
  of Eratosthenes</a>.
  Case 2 implies that <b>A</b> can be any odd integer, so in this case X is in the form of
  (4*X+2) and hence can be counted in O(1) time.
  Case 3 implies that <b>A</b>=1 or an odd prime. One can count the number of primes within range
  [<b>L</b>/4, <b>R</b>/4].
  Case 4 implies that X=8. Count it whenever 8 belongs to the range.
</p>
<p>
From the above case analysis, one can see that the running time is dominated by
Sieve of Eratosthenes. Fortunately, we only need to use sieve method on arrays of size
O(<b>R</b>-<b>L</b>+1) to count the number of odd primes within ranges [<b>L</b>, <b>R</b>] and
[<b>L</b>/4, <b>R</b>/4]. If we apply sieving using numbers 2, 3, 4, ..., &radic;<b>R</b>, the
algorithm runs in O(<b>T</b>*(<b>R</b> - <b>L</b> + 1)*log(&radic;<b>R</b>)) time,
which suffices to pass this test set.
</p>
<p>
For a more efficient algorithm, one can sieve using prime numbers no more than &radic;<b>R</b>.
  These prime numbers again can be
obtained by a sieving algorithm. At the end you will get an algorithm that runs in
O(&radic;<b>R</b> log log &radic;<b>R</b>) + O((<b>R</b> - <b>L</b> + 1) log log &radic;<b>R</b>) time
  per test case.
</p>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>


    </div>
  </body>
</html>
