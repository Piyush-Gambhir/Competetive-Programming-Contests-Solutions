
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Kick Start 2022 - Round F</h3><h1>Story of Seasons</h1><h3>Problem</h3>

<p>
  You are a super farmer with some vegetable seeds and an infinitely large farm. In fact, not only
  are you a farmer, but you are also secretly a super programmer! As a super programmer, you hope
  to maximize the profit of your farming using your programming skills.
</p>

<p>
  Since your daily energy is limited, you can plant at most $$$\mathbf{X}$$$ seeds each day. In the
  beginning, you have $$$\mathbf{N}$$$ kinds of vegetable seeds. The number of seeds of the $$$i$$$-th kind of
  vegetable is $$$\mathbf{Q_i}$$$, and each seed of this kind needs $$$\mathbf{L_i}$$$ days to mature from the day it is
  planted. Once it matures, you can sell it for $$$\mathbf{V_i}$$$ dollars. Assume that no energy or time is
  required for harvesting and selling vegetables. Also, your
  farm is infinitely large so the growing vegetables do not crowd out each other.
</p>

<p>
  Notice that although the area of your farm is infinite, the number of days that you can plant seeds
  is limited. The warm season only lasts $$$\mathbf{D}$$$ days, and after that, the harsh winter comes. Any
  vegetable that has not matured yet will die immediately and cannot be turned into profit. The remaining
  seeds that were not planted cannot be turned into profit either.
</p>

<p>
  As a super farmer and a super programmer, you want to come up with a perfect planting plan that will
  maximize your profit. Find the total amount of profit you will earn.
</p>

<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, $$$\mathbf{T}$$$. $$$\mathbf{T}$$$ test cases follow.<br/>
  The first line of each test case contains three integers $$$\mathbf{D}$$$, $$$\mathbf{N}$$$, and $$$\mathbf{X}$$$: the number of days of
  the warm season, the number of kinds of vegetable seeds you have to start with, and the maximum number
  of seeds you can plant each day, respectively. <br/>
  The next $$$\mathbf{N}$$$ lines describe the seeds. The $$$i$$$-th
  line contains three integers $$$\mathbf{Q_i}$$$, $$$\mathbf{L_i}$$$, and $$$\mathbf{V_i}$$$: the quantity of this kind of seed, the
  number of days it needs to mature, and the value of each matured plant, respectively.
</p>

<h3>Output</h3>
<p>
  For each test case, output one line containing <code>Case #$$$x$$$: $$$y$$$</code>,
  where $$$x$$$ is the test case number (starting from 1) and $$$y$$$ is the maximum amount of money
  you can earn by optimizing your farming plan.
</p>

<h3>Limits</h3>
<p>
Memory limit: 1 GB.<br/>

$$$1 \le \mathbf{T} \le 100$$$.<br/>
$$$1 \le \mathbf{V_i} \le 10^6$$$, for all $$$i$$$.<br/>
$$$1 \le \mathbf{L_i} \le \mathbf{D}$$$, for all $$$i$$$.<br/>
</p>

<h4>Test Set 1</h4>
<p>
Time limit: 20 seconds.<br/>

$$$2 \le \mathbf{D} \le 1000$$$.<br/>
$$$1 \le \mathbf{N} \le 15$$$.<br/>
$$$\mathbf{X} = 1$$$.<br/>
$$$\mathbf{Q_i} = 1$$$, for all $$$i$$$.<br/>
</p>

<h4>Test Set 2</h4>
<p>
Time limit: 60 seconds.<br/>

$$$2 \le \mathbf{D} \le 10^5$$$.<br/>
$$$1 \le \mathbf{N} \le 10^5$$$.<br/>
$$$1 \le \mathbf{X} \le 10^9$$$.<br/>
$$$1 \le \mathbf{Q_i} \le 10^6$$$, for all $$$i$$$.<br/>
</p>

<h4>Test Set 3</h4>
<p>
Time limit: 60 seconds.<br/>

  $$$2 \le \mathbf{D} \le 10^{12}$$$.<br/>
  $$$1 \le \mathbf{N} \le 10^5$$$.<br/>
  $$$1 \le \mathbf{X} \le 10^9$$$.<br/>
  $$$1 \le \mathbf{Q_i} \le 10^6$$$, for all $$$i$$$.<br/>
  $$$\mathbf{D} \times \mathbf{X} \le 10^{18}$$$.<br/>
</p>


  <h3>Sample</h3>
  <i>
    Note: there are additional samples that are not run on submissions down below.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="story_of_seasons_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">2
5 4 1
1 2 3
1 3 10
1 4 5
1 2 2
5 1 1
1 1 1
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="story_of_seasons_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 18
Case #2: 1
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
In Sample Case #1, there are $$$\mathbf{D} = 5$$$ days, $$$\mathbf{N} = 4$$$ kinds of vegetables and you
can plant at most $$$\mathbf{X} = 1$$$ seed each day. Supposing the $$$4$$$ kinds of vegetables are
spinach, pumpkin, carrot and cabbage, we have that
<ul>
  <li> Spinach needs $$$2$$$ days to grow, each matured one is worth $$$3$$$ dollars, and you start with $$$1$$$ spinach seed.</li>
  <li> Pumpkin needs $$$3$$$ days to grow, each matured one is worth $$$10$$$ dollars, and you start with $$$1$$$ pumpkin seed.</li>
  <li> Carrot needs $$$4$$$ days to grow, each matured one is worth $$$5$$$ dollars, and you start with $$$1$$$ carrot seed.</li>
  <li> Cabbage needs $$$2$$$ days to grow, each matured one is worth $$$2$$$ dollars, and you start with $$$1$$$ cabbage seed.</li>
</ul>
<br>
The maximum profit you can make is $$$18$$$ dollars. One of the schedules you can use is:
<ul>
  <li> Day 1: plant $$$1$$$ carrot</li>
  <li> Day 2: plant $$$1$$$ pumpkin</li>
  <li> Day 3: plant $$$1$$$ spinach</li>
  <li> Day 4: plant $$$1$$$ cabbage</li>
  <li> Day 5: do nothing</li>
</ul>
<br>
And with this schedule, the vegetables will mature and turn into profit as following days:
<ul>
  <li> Day 1: nothing harvested</li>
  <li> Day 2: nothing harvested</li>
  <li> Day 3: nothing harvested</li>
  <li> Day 4: nothing harvested</li>
  <li> Day 5: $$$1$$$ spinach, $$$1$$$ pumpkin and $$$1$$$ carrot harvested, you earn $$$18$$$ dollars</li>
</ul>
<br>
Note that the cabbage is supposed to mature on day $$$6$$$, but it will actually die because of the winter.


  <br/>
  <h3>Additional Sample - Test Set 2</h3>
  <i>
    The following additional sample fits the limits of Test Set 2. It will not
    be run against your submitted solutions.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="story_of_seasons_sample_ts2_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_1">1
5 3 4
5 2 3
2 3 10
2 4 5
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="story_of_seasons_sample_ts2_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_1">Case #1: 45</pre>
        </div>
      </div>
    </div>
  </div>


<p>
In Additional Sample Case #1, there are $$$\mathbf{D} = 5$$$ days, $$$\mathbf{N} = 3$$$ kinds of vegetables and you
can plant at most $$$\mathbf{X} = 4$$$ seeds each day. Supposing the $$$3$$$ kinds of vegetables are
spinach, pumpkin and carrot, we have that
<ul>
  <li> Spinach needs $$$2$$$ days to grow, each matured one is worth $$$3$$$ dollars, and you start with $$$5$$$ spinach seeds.</li>
  <li> Pumpkin needs $$$3$$$ days to grow, each matured one is worth $$$10$$$ dollars, and you start with $$$2$$$ pumpkin seeds.</li>
  <li> Carrot needs $$$4$$$ days to grow, each matured one is worth $$$5$$$ dollars, and you start with $$$2$$$ carrot seeds.</li>
</ul>
<br>
The maximum profit you can make is $$$45$$$ dollars. One of the schedules you can use is:
<ul>
  <li> Day 1: plant $$$1$$$ pumpkin, $$$2$$$ carrots and $$$1$$$ spinach</li>
  <li> Day 2: plant $$$2$$$ spinach and $$$1$$$ pumpkin</li>
  <li> Day 3: plant $$$2$$$ spinach</li>
  <li> Day 4: do nothing</li>
  <li> Day 5: do nothing</li>
</ul>
<br>
And with this schedule, the vegetables will mature and turn into profit as following days:
<ul>
  <li> Day 1: nothing harvested</li>
  <li> Day 2: nothing harvested</li>
  <li> Day 3: $$$1$$$ spinach harvested, you earn $$$3$$$ dollars</li>
  <li> Day 4: $$$2$$$ spinach and $$$1$$$ pumpkin harvested, you earn $$$16$$$ dollars</li>
  <li> Day 5: $$$2$$$ spinach, $$$1$$$ pumpkin and $$$2$$$ carrots harvested, you earn $$$26$$$ dollars</li>
</ul>

    </div>
  </body>
</html>
