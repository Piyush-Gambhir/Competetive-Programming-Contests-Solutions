
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Kick Start 2022 - Round F</h3><h1>Water Container System</h1><h3>Problem</h3>
<p>
  There is a water container system with $$$\mathbf{N}$$$ identical containers, which can be
  represented as a tree, where each container is a vertex. The containers are
  connected to each other with $$$\mathbf{N}-1$$$ bidirectional pipes. Two containers
  connected to each other are always placed on adjacent levels. Formally, if two
  containers $$$a$$$ and $$$b$$$ are connected to each other, then $$$|level_a -
  level_b | = 1$$$. Container $$$1$$$ is placed at the bottommost level. Each
  container is connected to exactly one container on the level below (the only
  exception is container $$$1$$$, which has no connections below it), but can be
  connected to zero or more containers on the level above. The maximum capacity
  of each container is $$$1$$$ liter, and initially all the containers are
  empty. Assume that the pipe has a capacity of $$$0$$$ liters. In other words,
  they do not store any water, but only allow water to pass through them in any
  direction.
</p>
<p>
  Consider the following diagram which is an example of a water container
  system:
</p>
<p align="center">
  <img
    src="images/water_container_problem_statement.png"
    width="50%"
    alt="Image of the water container system for the problem statement"
  />
</p>
<p>
  The first level of the system consists of a single container, container
  $$$1$$$ (root). Container $$$1$$$ is connected to container $$$2$$$ and
  container $$$3$$$, which are present in the above level, level $$$2$$$.
  Container $$$2$$$ is also connected to container $$$4$$$, which is present at
  level $$$3$$$.
</p>
<p>
  You are given $$$\mathbf{Q}$$$ queries. Each query contains a single integer $$$i$$$ which
  represents a container. For each query, add an additional $$$1$$$ liter of
  water in container $$$i$$$.
</p>
<p>
  The following diagram illustrates the flow of the water in the system in
  different conditions:
</p>
<p align="center">
  <img
    src="images/water_container_flow.png"
    width="100%"
    alt="Image describing the flow of water in the water container system"
  />
</p>
<p>
  In step $$$1$$$, after adding $$$1$$$ liter of water in container $$$3$$$, the
  water flows downward because the water containers at the lower level are still
  empty.<br />
  In step $$$2$$$, after adding $$$1$$$ liter of water in container $$$3$$$, the
  water flows downward, but as the container $$$1$$$ is already filled
  completely, the water is distributed evenly between water containers $$$2$$$
  and $$$3$$$.<br />
  In step $$$3$$$, after adding $$$1$$$ liter of water in container $$$3$$$, the
  water containers $$$2$$$ and $$$3$$$ are completely filled. <br />
  In step $$$4$$$, after adding $$$1$$$ liter of water in container $$$3$$$, the
  water is pushed up to water container $$$4$$$, which is then completely
  filled.<br />
</p>
<p>
  As illustrated in the example above, containers at the same level will have
  the same amount of water. Find the number of water containers that are
  completely filled after processing all the queries.
</p>
<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, $$$\mathbf{T}$$$. $$$\mathbf{T}$$$ test
  cases follow.<br />
  The first line of each test case contains the two integers $$$\mathbf{N}$$$ and $$$\mathbf{Q}$$$, where
  $$$\mathbf{N}$$$ is the number of containers and $$$\mathbf{Q}$$$ is the number of queries.<br />
  The next $$$\mathbf{N}-1$$$ lines contain two integers $$$i$$$ and $$$j$$$ ($$$1 \le
  i, j \le \mathbf{N}$$$, and $$$i &ne; j$$$) meaning that the $$$i$$$-th water
  container is connected to the $$$j$$$-th water container.<br />
  Each of the next $$$\mathbf{Q}$$$ lines contain a single integer $$$i$$$ ($$$1 \le i \le
  \mathbf{N}$$$) that represents the container to which $$$1$$$ liter of water should
  be added.
</p>

<h3>Output</h3>
<p>
  For each test case, output one line containing
  <code>Case #$$$x$$$: $$$y$$$</code>, where $$$x$$$ is the test case number
  (starting from 1) and $$$y$$$ is the number of water containers that are
  completely filled after processing all the queries.
</p>

<h3>Limits</h3>
<p>
Memory limit: 1 GB.<br/>

  $$$1 \le \mathbf{T} \le 100$$$.<br />
  $$$1 \le \mathbf{Q} \le \mathbf{N}$$$.<br />
  It is guaranteed that the given water container system is a tree.
</p>

<h4>Test Set 1</h4>
<p>
Time limit: 20 seconds.<br/>

  $$$1 \le \mathbf{N} \le 65535$$$.<br />
  The water container system is a
  <a
    href="https://en.wikipedia.org/w/index.php?title=Binary_tree#Types_of_binary_trees"
    target="_blank"
  >
    perfect binary tree</a
  >.
</p>

<h4>Test Set 2</h4>
<p>
Time limit: 60 seconds.<br/>

  $$$1 \le \mathbf{N} \le 10^4$$$.<br />
</p>


  <h3>Sample</h3>
  <i>
    Note: there are additional samples that are not run on submissions down below.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="water_container_system_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">2
1 1
1
3 2
1 2
1 3
1
2
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="water_container_system_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 1
Case #2: 1</pre>
        </div>
      </div>
    </div>
  </div>

<p>
  In Sample Case #1, there is $$$\mathbf{N} = 1$$$ water container. The number of
  completely filled water containers after adding $$$1$$$ liter of water in
  container $$$1$$$ is $$$1$$$.
</p>
<p>
  In Sample Case #2, there are $$$\mathbf{N} = 3$$$ water containers. The number of
  completely filled water containers after processing all the queries is
  $$$1$$$.
</p>
<p align="center">
  <img
    src="images/water_container_sample_test_1.png"
    width="100%"
    alt="Image describing the flow of water in the test set 1"
  />
</p>
<p>
  After adding $$$1$$$ liter of water in container $$$1$$$: container $$$1$$$
  is completely filled, and the remaining containers are empty.<br />
  After adding $$$1$$$ liter of water in container $$$2$$$: container $$$1$$$
  is completely filled, and containers $$$2$$$ and $$$3$$$ are partially
  filled.
</p>


  <br/>
  <h3>Additional Sample - Test Set 2</h3>
  <i>
    The following additional sample fits the limits of Test Set 2. It will not
    be run against your submitted solutions.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="water_container_system_sample_ts2_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_1">2
4 4
1 2
1 3
2 4
3
3
3
3
5 2
1 2
5 3
3 1
2 4
4
5
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="water_container_system_sample_ts2_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_1">Case #1: 4
Case #2: 1</pre>
        </div>
      </div>
    </div>
  </div>

<p>
  In Sample Case #1, there are $$$\mathbf{N} = 4$$$ water containers. The number of
  completely filled water containers after processing all the queries is
  $$$4$$$, which is already explained in the problem statement.
</p>
<p>
  In Sample Case #2, there are $$$\mathbf{N} = 5$$$ water containers. The number of
  completely filled water containers after processing all the queries is
  $$$1$$$.
</p>
<p align="center">
  <img
    src="images/water_container_sample_test_2.png"
    width="100%"
    alt="Image describing the flow of water in the test set 2"
  />
</p>
<p>
  After adding $$$1$$$ liter of water in container $$$4$$$: container $$$1$$$
  is completely filled, and the remaining containers are empty.<br />
  After adding $$$1$$$ liter of water in container $$$5$$$: container $$$1$$$
  is completely filled, containers $$$2$$$ and $$$3$$$ are partially filled,
  and the remaining containers are empty.
</p>

    </div>
  </body>
</html>
