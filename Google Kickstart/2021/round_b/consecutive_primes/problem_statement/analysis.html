
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Kick Start 2021 - Round B</h3><h1>Analysis: Consecutive Primes</h1><h3>
    Test Set 1
</h3>

<p>
Say $$$P(n)$$$ denotes the number of primes up to $$$n$$$, then the number of
possible products of consecutive primes will be $$$P(n) - 1$$$. For this test
set, we can find all the primes up to $$$n = 2021$$$ and generate the list of
products of consecutive primes. Each query can then be answered by searching for
the largest product which is still smaller than or equal to the given query.
</p>

<p>
<i>Complexity analysis:</i>
</p>

<ol>
    <li>To generate primes, we can test all $$$i$$$ up to $$$n$$$ for primality
        by checking if any integer from $$$2$$$ to $$$i - 1$$$ divides $$$i$$$.
        This takes $$$\sum_{i=0}^{n-2}i = O(n^2)$$$</li>
    <li>Generating the list of products of consecutive primes from the prime
        list takes $$$O(n)$$$ (a tighter bound will be $$$O(P(n))$$$ but we do
        not require it for this case)</li>
    <li>To answer all the queries, the complexity is $$$O(T \times n)$$$</li>
</ol>

<p>
So, the total complexity is $$$O(n^2) + O(T \times n)$$$ which is well under the
required time limit for $$$n = 2021$$$.
</p>

<h3>
Test Set 2
</h3>

<p>
We do not need to generate all the primes up to $$$n$$$, but only until we find
a prime which is greater than $$$\sqrt{n}$$$. The product of consecutive primes
larger than $$$\sqrt{n}$$$ will be greater than $$$n$$$. For this test set,
$$$n$$$ can be up to $$$10^9$$$, so we can generate primes up to $$$10^5$$$
(rounding off $$$10^{4.5}$$$ to cover the one up case as well) using
<a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes">Sieve of Eratosthenes</a>.
</p>

<p>
<i>Complexity analysis:</i> $$$O( \sqrt{n} \times \log( \log( \sqrt{n} ) ) )$$$ (for
sieve) + $$$O( T \times P(\sqrt{n}) )$$$ (for queries) which is well under the
required time limit for $$$n = 10^9$$$.
</p>

<h3>
    Test Set 3
</h3>
<p>
Our previous strategy of generating primes up to $$$\sqrt{n}$$$ will not work in
this case as $$$\sqrt{n}$$$ can be as large as $$$10^{9}$$$.
</p>

<p>
For any input $$$n$$$, there can be only two scenarios:
</p>

<ul>
    <li>The solution is the product of the largest prime smaller than or equal
        to $$$\sqrt{n}$$$ and the smallest prime greater than
        $$$\sqrt{n}$$$. Product of consecutive primes larger than that will be
        larger than $$$n$$$.</li>
    <li>The solution is the product of two largest primes smaller than or equal
        to $$$\sqrt{n}$$$. This will be less than $$$n$$$ and any product of
        consecutive primes less than that will be even smaller.</li>
</ul>

<p>
So, we need primes only in the vicinity of $$$\sqrt{n}$$$, specifically in the
worst case, $$$2$$$ primes smaller than or equal to $$$\sqrt{n}$$$ and one prime
larger than $$$\sqrt{n}$$$.
</p>

<p>
Now, how far out can the closest prime be from any given $$$\sqrt{n}$$$? This
series of numbers is known as
<a href="https://en.wikipedia.org/wiki/Prime_gap">maximal prime gaps</a>
and for $$$\sqrt{n} = 10^{9}$$$ (for maximum possible $$$n = 10^{18}$$$), this
number is $$$282$$$ (called $$$max\_gap$$$ from now on). So, we can iterate
backwards from $$$\sqrt{n}$$$ until we find $$$2$$$ primes and then iterate
ahead from $$$\sqrt{n}$$$ for $$$1$$$ more prime. In the worst case we would
need to check integers in range $$$[\sqrt{n} - max\_gap \times 2, \sqrt{n} +
max\_gap]$$$.
</p>

<p>
<i>Complexity analysis:</i> $$$O( \sqrt[4]{n} \times 3 \times max\_gap \times T
)$$$ <br/> (primality check over $$$3 \times max\_gap$$$ possible integers for
$$$T$$$ test cases)
</p>

<p>
<i>Note:</i> The above complexity is not a tight bound. It's hard to hit the
worst case scenario and even then most of the primality checks will terminate
earlier (using just the first $$$7$$$ primes, we can rule out $$$662$$$ integers
in any $$$3 \times 282$$$ range). A better
<a href="https://en.wikipedia.org/wiki/Primality_test">primality test</a> can be
used to further drive the complexity down.
<a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes#Segmented_sieve">
    Segmented sieve</a> can also be used to have deterministic complexity -
$$$O( ( \sqrt[4]{n} + 3 \times max\_gap \times T) \times \log( \log( \sqrt[4]{n}
)))$$$.
</p>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>


    </div>
  </body>
</html>
