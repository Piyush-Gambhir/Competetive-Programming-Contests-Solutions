
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Kick Start 2017 - Round C</h3><h1>Analysis: The 4M Corporation</h1><h2>The 4M Corporation: Analysis</h2>
<h3>Small dataset</h3>
<p>
  The Limits section of the problem statement tells us that the answer to
  every Small test case that is not <code>IMPOSSIBLE</code> is less than 14.
  This suggests that brute force is a viable option for the Small dataset. The
  tight bounds imposed by <b>MINIMUM</b> and <b>MAXIMUM</b> help us out as
  well. But let's think about the worst case: what if those two values are 1
  and 8, respectively, and what if the answer ends up being 13? In that case,
  we know that two of the values in the list must be 1 and 8, but if any of the
  others can be any integer in [1, 8], then we can have 8<sup>11</sup> &mdash;
  over 8 billion &mdash; possibilities for the remaining numbers. That's too
  much to handle in our limited time!
</p><p>
  Fortunately, we can cut this daunting space of possibilities down to size by
  avoiding redundant lists. In this problem, we don't care about the difference
  between [1, 1, 2, 3] and [2, 1, 3, 1], for instance. One way to avoid
  worrying about such differences is to only consider lists that are sorted in
  nondecreasing order. Even in the worst case mentioned above, there are only
  about 75,000 different nondecreasing lists that accord with the Small limits.
  (You can use a
  <a href="https://en.wikipedia.org/wiki/Stars_and_bars_(combinatorics)">combinatorial trick</a>
  to find this value, or you can just experiment and see.)
</p><p>
  One simple way to actually generate those lists is to start with a list
  consisting of only <b>MINIMUM</b>, then generate all new legal lists that
  append one more value to the end of that, then generate all new legal lists
  that append one value to the ends of <i>those</i> lists, and so on. Since the
  number of such lists is small, an approach like this is tractable. Once you
  have all the lists, you can check each of them to see if it has the desired
  properties, and return the length of the shortest such list, or
  <code>IMPOSSIBLE</code> if none of the lists works.
</p>

<h3>Large dataset</h3>

<p>
  With values in the [1, 10000] range, and no upper bound on the answer,
  we will never be able to generate all possible lists in time. We need a
  general, non-brute-force solution.
</p><p>
  Let's start with some special cases that might be easy to overlook:
</p>
<ul>
  <li>There are five sets of demands that make the task clearly
    <code>IMPOSSIBLE</code>, because they contradict the mathematical
    definitions of minimum, maximum, mean, and median:
    <ul>
      <li><b>MAXIMUM</b> &lt; <b>MINIMUM</b></li>
      <li><b>MAXIMUM</b> &lt; <b>MEDIAN</b></li>
      <li><b>MAXIMUM</b> &lt; <b>MEAN</b></li>
      <li><b>MEDIAN</b> &lt; <b>MINIMUM</b></li>
      <li><b>MEAN</b> &lt; <b>MINIMUM</b></li>
    </ul>
  </li>
  <li>The problem might be solvable with one department. This is possible if
    and only if <b>MINIMUM</b>, <b>MAXIMUM</b>, <b>MEAN</b>, and <b>MEDIAN</b>
    are all the same, so we can easily confirm or rule out this case.</li>
  <li>The problem might be solvable with two departments. This requires that
    <b>MEAN</b> and <b>MEDIAN</b> are both exactly (<b>MINIMUM</b> +
    <b>MAXIMUM</b>) / 2). If this is true, we have no reason to consider using
    more departments, so we are done.</li>
</ul>
<p>
  Otherwise, suppose that the problem is solvable with three departments. Then
  those three values must be <b>MINIMUM</b>, <b>MEDIAN</b>, and <b>MAXIMUM</b>.
  Assuming that these values do not already have the correct <b>MEAN</b>,
  perhaps we can insert more values until they do. We can repeatedly insert one
  value to the left of the median and one value to the right. First, we figure
  out how much the mean of the existing three values deviates from the desired
  mean. (To avoid errors associated with floating-point computation, it is
  better to compare the values' sum with <b>MEAN</b> times the number of
  values.) Suppose (without loss of generality) that the existing sum of values
  is too large. Then we can figure out which two values to insert to bring down
  this surplus as much as possible; usually, they will be another copy of
  <b>MINIMUM</b> (on the left) and another copy of <b>MEDIAN</b> (on the
  right). If inserting even one such pair won't reduce the surplus &mdash; that
  is, if <b>MEDIAN</b> + <b>MINIMUM</b> is no smaller than 2 &times;
  <b>MEAN</b> &mdash; then this method will never work. Otherwise, we can keep
  doing this until the surplus is gone. If inserting that last pair of
  <b>MINIMUM</b> and <b>MEDIAN</b> would overshoot the surplus by an amount K,
  we can just insert <b>MINIMUM</b> + K instead of the usual <b>MINIMUM</b>;
  this value will never exceed <b>MEDIAN</b>.) We don't even need to carry out
  each such step individually; we can figure out exactly how many will be
  needed.
</p><p>
  Note that since we always insert one value to the left of our original
  <b>MEDIAN</b> and one to the right, the list always has a copy of
  <b>MEDIAN</b> in the right place. Also, given any other valid list of odd
  length, we can sort that list's values in nondecreasing order and pair them
  off (ignoring the first, last and middle elements, which are fixed): the
  second value with the second-to-last value, etc. Each of the pairs produced by
  our method contributes maximally towards reducing the surplus (except possibly
  the last one of value <b>MINIMUM</b> + K).  So no valid list of odd length can
  be strictly shorter, as the total contribution would be strictly smaller.
</p><p>
  We aren't done yet, though, because the above method only produces lists with
  an odd number of elements. So, regardless of what that method determined, we
  need to try something similar starting with four departments: <b>MINIMUM</b>,
  <b>MEDIAN</b>, <b>MEDIAN</b>, and <b>MAXIMUM</b>. (You may notice that we
  could also consider <b>MEDIAN</b> - 1 and <b>MEDIAN</b> + 1, among other
  possible pairs, in place of <b>MEDIAN</b> and <b>MEDIAN</b>. But there is no
  reason to consider this, because it would only restrict the range of new
  values we can insert, and thus require more values to adjust the mean.) Once
  we get our answer from this four-department method, we can take the smaller
  of its answer and the three-department method's answer, or
  <code>IMPOSSIBLE</code> if neither method worked.
</p><p>
  This solution runs in constant time. Our efficiency-loving bosses at the 4M
  Corporation will certainly be happy with that!
</p>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>


    </div>
  </body>
</html>
