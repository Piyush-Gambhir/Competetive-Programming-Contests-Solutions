
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Kick Start 2020 - Round B</h3><h1>Analysis: Bus Routes</h1><p>
  We need to take the buses in order from 1 to <b>N</b>. Let the buses be B<sub>1</sub>,
  B<sub>2</sub>, ...., B<sub><b>N</b></sub>. Also, let us define a <i>good starting day</i> to be
  any day Y in the range [1..<b>D</b>] such that
  it is possible to start the journey on day Y and take all buses in the order from
  1 to <b>N</b> before the end of day <b>D</b>. Note that we do not require Y to be a multiple of
  <b>X<sub>1</sub></b>, so there may be some waiting time involved in the beginning of the journey.
</p>
<p>
  For a fixed day Y, let us see if it is a good starting day or not.
  The best strategy would be to take bus B<sub>1</sub> as early as possible on or after
  day Y.
  This is because it would give us more days to take subsequent buses. Let us say we took bus
  B<sub>1</sub> on day D<sub>1</sub>. Now the best strategy would be to take bus B<sub>2</sub>
  as early as possible on or after day D<sub>1</sub>. Thus, if we took bus B<sub>i</sub> on day
  D<sub>i</sub>, it would be optimal to take bus B<sub>i+1</sub> as early as possible on or after day
  D<sub>i</sub>.
</p>

<p>
  Now we need to find out what is the earliest possible day for Bucket to take
  bus B<sub>i</sub> on or after a particular day K. Since bus B<sub>i</sub> only runs on days
  that are multiples of <b>X<sub>i</sub></b>, we need to find the smallest multiple of
  <b>X<sub>i</sub></b> greater than or equal to K. This can be calculated using the formula
  &lceil; K / <b>X<sub>i</sub></b> &rceil; * <b>X<sub>i</sub></b>. Thus if bus B<sub>i</sub> is
  taken on day D<sub>i</sub>, then it would be optimal to take bus B<sub>i+1</sub> on day
  D<sub>i+1</sub> &equals; &lceil; D<sub>i</sub> / <b>X<sub>i+1</sub></b> &rceil; * <b>X<sub>i+1</sub></b>.
  Thus, day Y is a good starting day if D<sub><b>N</b></sub> &le; <b>D</b>, and this question
  can be answered in O(<b>N</b>) time.
</p>

<h3>Test set 1 </h3>
<p>
  <b>D</b> can be at most 100, so we can find the latest good starting day by using the above
  approach for each day Y in the range [1..<b>D</b>]. The time complexity of this naive algorithm
  is O(<b>DN</b>).
</p>

<h3>Test set 2 </h3>
<p>
  Now <b>D</b> can be at most 10<sup>12</sup>, so the naive algorithm would time out.
  Consider the largest good starting day P. Obviously, any day before P would be good as well
  because we can take the buses on the same days as if we started the journey on day P.
  Because of this observation, we can binary search on the range from 1 to <b>D</b> to find the
  largest good starting day P. The time complexity of the solution is O(<b>N</b> log <b>D</b>).
  Note that we can reduce the time complexity to O(<b>N</b> log(<b>D</b>/<b>X<sub>1</sub></b>)) by
  restricting the search to multiples of <b>X<sub>1</sub></b> only.
</p>

<h3>Alternate solution</h3>
<p>
  It is possible to solve the problem in linear time by working out the solution backwards.
  If we want to start our journey as late as possible, we should try to take the last bus
  B<sub><b>N</b></sub> as late a possible, namely, on day D<sub><b>N</b></sub>, which is the largest
  multiple of <b>X<sub>N</sub></b>, less than or equal to day <b>D</b>. Similarly, in order to be on
  time for the last bus on day D<sub><b>N</b></sub>, we have to take bus B<sub><b>N</b>-1</sub> no
  later than on day D<sub><b>N</b>-1</sub>, which is the largest multiple of
  <b>X<sub><b>N</b>-1</sub></b>, less than or equal to D<sub><b>N</b></sub>. In general, bus
  B<sub>i</sub> should be taken no later than on day D<sub>i</sub>, which is the largest
  multiple of <b>X<sub>i</sub></b>, less than or equal to D<sub>i+1</sub>. The last calculated value
  D<sub>1</sub> is the answer to the problem.
</p>
<p>
  Note that the largest multiple of
  <b>X<sub>i</sub></b> that occurs before a day L can be calculated in constant time as L - L mod
  <b>X<sub>i</sub></b>. Therefore, the overall time complexity of this solution is O(<b>N</b>).
</p>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>


    </div>
  </body>
</html>
