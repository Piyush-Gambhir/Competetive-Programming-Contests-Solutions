
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Kick Start 2020 - Round F</h3><h1>Painters' Duel</h1><h3>Problem</h3>
<p>
  A new art museum is about to open! It is a single-story building in the shape of a large
  equilateral triangle. That triangle is made up of many smaller identical
  equilateral-triangle-shaped rooms, and the side length of the museum is <b>S</b> times the side
  length of any one of the rooms. Each room has doors connecting it to all other rooms with which
  it shares a side (not just a vertex).
</p><p>
  Each room is identified by two numbers: the row of the building it is in (counting
  from top to bottom, starting from 1), followed by its position within that row (counting from
  left to right, starting from 1). Here is an example of how the rooms are connected and labeled
  when <b>S</b> = 3:
</p><p style="text-align:center">
  <img src="images/example.png"/>
</p><p>
  Alma and Berthe are artists who are painting the rooms of the museum. Alma starts in the room
  (<b>R<sub>A</sub></b>, <b>P<sub>A</sub></b>), and Berthe starts in a different room
  (<b>R<sub>B</sub></b>, <b>P<sub>B</sub></b>). Each of them has already painted their starting
  room. <b>C</b> of the other rooms of the museum are under construction, and neither Alma nor
  Berthe is allowed to enter these rooms or paint them.
</p><p>
  Alma and Berthe are having a friendly competition and playing a turn-based game, with Alma
  starting first. On a painter's turn, if their current room is adjacent to at least one
  unpainted room that is not under construction, the painter must choose one of those rooms,
  move to it, and paint it. Otherwise, the painter cannot move and does nothing on their turn.
  Once both painters are unable to move, the game is over. The score of the game is the number of
  rooms painted by Alma minus the number of rooms painted by Berthe.
</p><p>
  Both painters make optimal decisions, with Alma trying to maximize the score and Berthe trying
  to minimize the score. Given this, determine the best score Alma can guarantee for the game,
  regardless of what Berthe does.
</p>

<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, <b>T</b>. <b>T</b> test cases follow.
  Each case begins with one line containing six integers <b>S</b>, <b>R<sub>A</sub></b>,
  <b>P<sub>A</sub></b>, <b>R<sub>B</sub></b>, <b>P<sub>B</sub></b>, and <b>C</b>. Respectively,
  these are the side length of the museum (as a multiple of the side length of a room), the row and
  position of Alma's starting room, the row and position of Berthe's starting room, and the number
  of rooms that are under construction. Then, there are <b>C</b> more lines. The i-th of these
  lines (counting starting from 1) contains two integers <b>R<sub>i</sub></b> and
  <b>P<sub>i</sub></b>, representing the row and position of the i-th room that is under
  construction.
</p>

<h3>Output</h3>
<p>
  For each test case, output one line containing <code>Case #x: y</code>, where <code>x</code> is
  the test case number (starting from 1) and <code>y</code> is the best score that Alma can
  guarantee for the game, as described above.
</p>

<h3>Limits</h3>
<p>
Time limit: 40 seconds.<br/>
Memory limit: 1 GB.<br/>

  0 &le; <b>C</b> &le; <b>S</b><sup>2</sup> - 2.<br/>
  1 &le; <b>R<sub>A</sub></b> &le; <b>S</b>.<br/>
  1 &le; <b>P<sub>A</sub></b> &le; 2 &times; <b>R<sub>A</sub></b> - 1.<br/>
  1 &le; <b>R<sub>B</sub></b> &le; <b>S</b>.<br/>
  1 &le; <b>P<sub>B</sub></b> &le; 2 &times; <b>R<sub>B</sub></b> - 1.<br/>
  (<b>R<sub>A</sub></b>, <b>P<sub>A</sub></b>) &ne; (<b>R<sub>B</sub></b>, <b>P<sub>B</sub></b>).<br/>
  1 &le; <b>R<sub>i</sub></b> &le; <b>S</b>, for all i.<br/>
  1 &le; <b>P<sub>i</sub></b> &le; 2 &times; <b>R<sub>i</sub></b> - 1, for all i.<br/>
  (<b>R<sub>i</sub></b>, <b>P<sub>i</sub></b>) &ne; (<b>R<sub>A</sub></b>, <b>P<sub>A</sub></b>),
    for all i.<br/>
  (<b>R<sub>i</sub></b>, <b>P<sub>i</sub></b>) &ne; (<b>R<sub>B</sub></b>, <b>P<sub>B</sub></b>),
    for all i.<br/>
  Either <b>R<sub>i</sub></b> &lt; <b>R<sub>i+1</sub></b>, or
    <b>R<sub>i</sub></b> = <b>R<sub>i+1</sub></b> and <b>P<sub>i</sub></b> &lt; <b>P<sub>i+1</sub></b>,
    for all i &lt; <b>C</b>.<br/>
</p>

<h4>Test Set 1</h4>
<p>

  <b>T</b> = 48.<br/>
  <b>S</b> = 2.<br/>
</p>

<h4>Test Set 2</h4>
<p>

  1 &le; <b>T</b> &le; 100.<br/>
  2 &le; <b>S</b> &le; 6.<br/>
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="painters_duel_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">2
2 1 1 2 1 0
2 2 2 1 1 2
2 1
2 3
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="painters_duel_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 2
Case #2: 0
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  In Sample Case #1, the turns must proceed as follows:
</p>
<ol>
  <li>Alma moves to room (2, 2).</li>
  <li>Berthe cannot move.</li>
  <li>Alma moves to room (2, 3).</li>
  <li>Berthe still cannot move.</li>
  <li>Alma cannot move. Since neither painter can move, the game is now over.</li>
</ol>
<p>
  Alma has painted 3 rooms and Berthe has painted 1 room, so the score is 3 - 1 = 2.
</p>
<p>
  In Sample Case #2, neither painter can move. They only paint their starting rooms.
</p>
<p>
  The following additional cases could not appear in Test Set 1, but could appear in Test Set 2.
</p>
<pre>
2
3 3 4 2 1 2
2 3
3 1
3 3 2 2 3 2
2 1
3 1
</pre>
<p>
  The correct output for these two cases would be:
</p>
<pre>
Case #1: 0
Case #2: -1
</pre>
<p>
  In Case #1, Alma can move to (3, 5) or (3, 3). She cannot move to (2, 3), which is under
  construction.
</p>
<ul>
  <li>If she moves to (3, 5), she will have no more moves and Berthe will go on to paint
    two more rooms. Score: 2 - 3 = -1.</li>
  <li>If Alma moves to (3, 3), then Berthe can do one of the following:
    <ul>
      <li>Move to (3, 2), leaving neither painter with any future moves. Score: 2 - 2 = 0.</li>
      <li>Move to (2, 2). Then the rest of the game must play out as follows: Alma moves to
        (3, 2), Berthe moves to (1, 1). Score: 3 - 3 = 0.</li>
    </ul>
  </li>
</ul>
<p>
  So Alma knows that moving to (3, 3) guarantees a score of 0 no matter what Berthe does, which is
  better than the score of -1 that she would get by moving to (3, 5). Therefore, Alma moves to
  (3, 3). Notice that:
</p>
<ul>
  <li>We do not know exactly how the rest of this game will play out, but we do know the best
    score that Alma can guarantee.</li>
  <li>It is possible that one or more rooms that are not under construction do not get painted.</li>
</ul>
<p>
  In Case #2, Alma must move to (3, 3), and then it is better for Berthe to move to (3, 4)
  than to (2, 2).
</p>

    </div>
  </body>
</html>
