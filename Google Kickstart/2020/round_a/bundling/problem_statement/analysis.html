
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Kick Start 2020 - Round A</h3><h1>Analysis: Bundling</h1><p>
  We need to maximise the sum of scores of each bundle. Let us consider a bundle and say longest
  prefix shared by all strings of this bundle is of length X. Now each prefix of length from
  1 to X is shared by all of the strings in this bundle. Consider any prefix among these X prefixes, it
  is counted once in the score of this bundle. Thus the score of a bundle can be defined as number of
  prefixes that are shared by all of the strings in this bundle. Thus if a prefix is shared by all
  strings in Y bundles, then it will contribute Y to the total sum of scores.
</p>

<p>
  Now instead of finding the total score, we find the contribution of each prefix in the total score.
  So for maximising the total score, we would want to maximize the contribution of each prefix in
  the total score. Let the contribution of each prefix PRE be contibution(PRE). We want to maximize
  &sum; contribution(PRE) where PRE comprises all possible prefixes of the given strings.
</p>

<p>
  Let us say a prefix P<sub>i</sub> is a prefix of S strings. The maximum number of bundles of size
  <b>K</b> formed by S strings is &lfloor; S / <b>K</b> &rfloor;. In each of these
  &lfloor; S / <b>K</b> &rfloor; bundles, prefix P<sub>i</sub> will add to their scores. Thus maximum
  value of contribution(P<sub>i</sub>) can be &lfloor; S / <b>K</b> &rfloor;. So a prefix
  P<sub>i</sub> which occurs as a prefix of S strings will contribute &lfloor; S / <b>K</b> &rfloor;
  to the answer.
</p>

<p>
  Let us see if we can achieve this maximum value for all the prefixes. Consider a prefix P of
  length L. It occurs as a prefix in CNT number of strings. Now consider there are C prefixes of
  length L + 1 which contain the prefix P as a prefix
  (P<sub>1</sub>, P<sub>2</sub>, ....,P<sub>C</sub>). And we have stored the number of strings these
  prefixes are part of as (CNT<sub>1</sub>, CNT<sub>2</sub>, ....,CNT<sub>C</sub>).
</p>

<p>
  Let us say we divided the strings which have prefix P<sub>i</sub> into
  &lfloor; (CNT<sub>i</sub> / <b>K</b>) &rfloor; bundles. Now we have CNT<sub>i</sub>%<b>K</b>
  strings remaining for each prefix that we need to arrange so that they make a bundle. For each of
  these remaining strings we cannot have a bundle of size <b>K</b> which would have a common prefix
  of length L + 1 because we have CNT<sub>i</sub>%<b>K</b> remaining strings for each P<sub>i</sub>.
  So, we can make bundles in any order using the remanining strings. Those bundles will still have a
  prefix of length L shared among them. Thus we would be left with CNT%<b>K</b> number of strings
  which are not in any bundle when we consider prefix P. We can continue this procedure till we are
  left with prefix of length 0. We would be able to bundle all the strings at this point because we
  would have <b>N</b> % <b>K</b> strings remaining, and as specified in the problem, <b>N</b> is
  divisible by <b>K</b>.
</p>

<p>
  The problem is now reduced to finding number of times each prefix occurs in the given strings. Let
  this number be COUNT. We just need to add &lfloor; COUNT / <b>K</b> &rfloor; to the answer for
  each prefix.
</p>

<h3>Test set 1 </h3>
<p>
  The length of each string is at most 5. Thus we have total number of prefixes as <b>N</b> * 5 and each
  prefix can be of size at most 5. Store each prefix in a hashmap and increase the count for each
  prefix. In the end, we just need to add &lfloor; (count(i) / <b>K</b>) &rfloor; for each prefix i. The
  complexity of the solution would be O(<b>N</b> * 5 * 5).
</p>

<h3>Test set 2 </h3>
<p>
  Let the sum of length of all strings over all the test cases be SUM which is 10<sup>6</sup>. For
  the large test set, the length of the string can be very large. So, we can't store all the
  prefixes in a hashmap. We need to store all the prefixes in an efficient manner along with the
  number of times they occur in given strings. We can use a data structure
  <a href="https://en.wikipedia.org/wiki/Trie">trie</a>. The insertion cost would be equal to sum of
  length of strings over the test cases which is  O(SUM). Then finally we just need to traverse the
  trie and for each prefix, add its contribution to the answer. Time complexity of the solution
  would be O(SUM).
</p>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>


    </div>
  </body>
</html>
