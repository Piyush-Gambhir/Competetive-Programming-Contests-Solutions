
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Kick Start 2018 - Round A</h3><h1>Scrambled Words</h1><h3>Problem</h3>
<p>
  Professor Scrmable noticed spelling mistakes in a research paper she was reviewing, but she had no
  difficulty in reading or understanding the words. Upon doing some research, she found an
  interesting <a href="http://www.mrc-cbu.cam.ac.uk/people/matt.davis/Cmabrigde/">article</a> as described below:
</p>

<p>
  According to a study at an English University, it doesn't matter in what order the letters in a
  word are, the only important thing is that the first and last letter be at the correct place. The
  rest can be a total mess and you can still read it without a problem. This is because the human
  mind does not read every letter by itself but the word as a whole.
</p>

<p>
  Or rather ...
</p>

<p>
  Aoccdrnig to a study at an Elingsh uinervtisy, it deosn't mttaer in waht oredr the ltteers in a
  wrod are, the olny iprmoetnt tihng is taht the frist and lsat ltteer be at the corecrt pclae. The
  rset can be a toatl mses and you can sitll raed it wouthit a porbelm. Tihs is bcuseae the huamn
  mnid deos not raed ervey lteter by istlef, but the wrod as a wlohe.
</p>

<p>
  Professor Scrmable wants to explore this concept further and starts compiling different sentences
  containing similarly scrambled words to send to a popular publication. Unfortunately, the space
  key on the professor's keyboard is not working, so she has produced one long string of characters.
  She has asked you to determine how many of the words in her dictionary appear (at least once) as
  substrings in the long string of characters, either in their original or scrambled forms.
  (A scrambled form consists of the same set of letters with the first and last letters in the same
  places, and the others in any order.)
</p>
<p>
  Note that a dictionary word can appear multiple times in the string (though it should be counted
  only once since we only need to know whether it shows up at least once). For example, if we had the
  word <code>this</code> in the dictionary, the possible valid words which would be counted are
  <code>this</code> (original version) and <code>tihs</code> (scrambled version), whereas
  <code>tsih</code>, <code>siht</code> and other variations are not valid since they do not start
  with <code>t</code> and end with <code>s</code>. Also, <code>tis</code>, <code>tiss</code>, and
  <code>thiss</code> are not scrambled forms, because they are not reorderings of the original set of letters.
</p>
<p>
  Since the professor is extremely busy, she gives this task to you, her favorite and most trusted
  research assistant. Given a dictionary, can you count the number of words in the dictionary
  that appear as a substring in the professor's string at least once, in either their scrambled or
  original forms.
</p>


<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, <b>T</b>. <b>T</b> test cases follow.
  Each testcase contains three lines. The first line contains an integer <b>L</b>. The second line
  contains a list of <b>L</b> words made of lowercase English letters; these make up the dictionary.
  The third line contains two lowercase English letters <b>S<sub>1</sub></b> and <b>S<sub>2</sub></b>, and five integers <b>N</b>, <b>A</b>,
  <b>B</b>, <b>C</b> and <b>D</b>.
  <b>S<sub>1</sub></b> and <b>S<sub>2</sub></b> are the first two characters of the professor's string <b>S</b>,
  <b>N</b> is the length of <b>S</b>, and the other four integers are parameters that you should use to generate the
  characters of <b>S</b>, as follows:
</p>
<p>
  First we define ord(<code>c</code>) as the decimal value of a character <code>c</code> and
  char(n) as the character value of a decimal n. For example,
  ord(<code>'a'</code>) = 97 and char(97) = <code>'a'</code>. You can refer to
  <a href="https://en.wikipedia.org/wiki/ASCII#Printable_characters">ASCII table</a>
  for other conversions.
  <br/>
  <br/>
Now, define x<sub>1</sub> = ord(<b>S<sub>1</sub></b>), x<sub>2</sub> = ord(<b>S<sub>2</sub></b>). Then,
  use the recurrence below to generate x<sub>i</sub> for i = 3 to <b>N</b>:
<ul>
  <li>x<sub>i</sub> = ( <b>A</b> * x<sub>i-1</sub> + <b>B</b> * x<sub>i-2</sub> + <b>C</b> ) modulo <b>D</b>.</li>
</ul>
  We define <b>S<sub>i</sub></b> = char(97 + ( x<sub>i</sub> modulo 26 )), for all i = 3 to <b>N</b>.
</p>

<h3>Output</h3>
<p>
  For each test case, output one line containing <code>Case #x: y</code>, where <code>x</code> is
  the test case number (starting from 1) and <code>y</code> is the number of words from the
  dictionary that appear (in their original or scrambled forms, as defined above) as substrings of the given string.
</p>

<h3>Limits</h3>
<p>
  1 &le; <b>T</b> &le; 20.<br/>
  Memory limit: 1 GB.<br/>
  No two words in the dictionary are the same.<br/>
  Each word in the dictionary is between 2 and 10<sup>5</sup> letters long, inclusive.<br/>
  The sum of lengths of all words in the dictionary does not exceed 10<sup>5</sup>.<br/>
  <b>S<sub>1</sub></b> and <b>S<sub>2</sub></b> are lowercase English letters.<br/>
  0 &le; <b>A</b> &le; 10<sup>9</sup>.<br/>
  0 &le; <b>B</b> &le; 10<sup>9</sup>.<br/>
  0 &le; <b>C</b> &le; 10<sup>9</sup>.<br/>
  1 &le; <b>D</b> &le; 10<sup>9</sup>.<br/>
</p>

<h4>Small dataset (Test set 1 - Visible)</h4>
<p>
  Time limit: 20 seconds.<br/>
  1 &le; <b>L</b> &le; 1000.<br/>
  2 &le; <b>N</b> &le; 1000.<br/>
</p>

<h4>Large dataset (Test set 2 - Hidden)</h4>
<p>
  Time limit: 150 seconds.<br/>
  1 &le; <b>L</b> &le; 20000.<br/>
  2 &le; <b>N</b> &le; 10<sup>6</sup>.<br/>
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="scrambled_words_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">1
5
axpaj apxaj dnrbt pjxdn abd
a a 50 1 1 1 30
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="scrambled_words_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 4
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  In Sample Case #1, using the generation method, the generated string <b>S</b> is <code>aapxjdnrbtvldptfzbbdbbzxtndrvjblnzjfpvhdhhpxjdnrbt</code>.
  Scrambled or original occurences of dictionary words are highlighted as follows:<br/>
  <ul>
    <li><code>axpaj</code> occurs in its scrambled form as <code><u>aapxj</u>dnrbtvldptfzbbdbbzxtndrvjblnzjfpvhdhhpxjdnrbt</code>.</li>
    <li><code>apxaj</code> occurs in its scrambled form as <code><u>aapxj</u>dnrbtvldptfzbbdbbzxtndrvjblnzjfpvhdhhpxjdnrbt</code>.
    Note that even though <code>apxaj</code> is the scrambled form of another dictionary word <code>axpaj</code>,
      both should be counted.</li>
    <li><code>dnrbt</code> occurs twice in its original form as <code>aapxj<u>dnrbt</u>vldptfzbbdbbzxtndrvjblnzjfpvhdhhpxj<u>dnrbt</u></code>,
    though it should be counted only once.</li>
    <li><code>pjxdn</code> occurs in its scrambled form as <code>aa<u>pxjdn</u>rbtvldptfzbbdbbzxtndrvjblnzjfpvhdhh<u>pxjdn</u>rbt</code>.
    Note this occurence overlaps with occurence of another dictionary word, but still they're counted independently.</li>
    <li><code>abd</code> doesn't occur at all.</li>
  </ul>
</p>
<p>
  <b>Note</b>: We do not recommend using interpreted/slower languages for the Large dataset of this problem.
</p>

    </div>
  </body>
</html>
