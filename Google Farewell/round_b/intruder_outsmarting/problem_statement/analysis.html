
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Coding Competitions Farewell Rounds - Round B</h3><h1>Analysis: Intruder Outsmarting</h1><h3>Reachable Numbers on a Wheel</h3>
<p>
  Let us first define the concept of "reachable numbers" on a wheel. These are
  the set of numbers that can be displayed on a wheel by rotating it in
  increments of $$$\mathbf{D}$$$, starting from the initial number on the wheel as given in
  the input.
</p>
<p>
  <b>Example:</b> Let us take $$$\mathbf{N} = 6$$$ and $$$\mathbf{D} = 4$$$, and we start from
  the number $$$1$$$ on the wheel. Then the reachable numbers are:
</p>
<p align="center">$$$1 + 4 = \textbf{5}$$$</p>
<p align="center">$$$5 + 4 = 9 \Rightarrow 9 - 6 = \textbf{3}$$$</p>
<p align="center">$$$3 + 4 = 7 \Rightarrow 7 - 6 = \textbf{1}$$$</p>
<p>
  Which brings us back to the beginning. Thus, our set of reachable numbers is
  {$$$1, 3, 5$$$}. Note here that we subtract $$$6$$$ from numbers $$$\gt 6$$$
  because of the circular sequence of numbers on the wheel.
</p>
<h3>Test Set 1</h3>
<p>
  We can try all combinations of reachable values on the wheels, check for each
  combination if it forms a palindrome and if it does, calculate the minimum
  number of operations required to form that combination.
</p>
<p>
  Each wheel can have a maximum of $$$\mathbf{N}$$$ reachable values. For $$$\mathbf{W}$$$ wheels, the
  number of possible combinations that can be shown on the security key will be
  of the order of $$$\mathbf{N}^{\mathbf{W}}$$$. A combination can be generated by generating
  the possible values for each wheel. For a given index $$$i$$$, we can start
  with $$$\mathbf{X}_i$$$, then incrementing the values in steps of $$$\mathbf{D}$$$. If the value
  overflows beyond $$$\mathbf{N}$$$, we circle back around to $$$1$$$ by subtracting $$$\mathbf{N}$$$,
  which then brings us to a value lying in $$$[1 \cdots \mathbf{N}]$$$. When we get to
  a value that we have previously encountered, we then have the complete set of
  values reachable for that index. In this way, we can generate all combinations
  by iterating through all possible reachable values for each index.
</p>
<p>
  For each index, the set of reachable positions can be generated in
  $$$O(\mathbf{N})$$$, and for $$$\mathbf{W}$$$ wheels, we can do this in $$$O(\mathbf{N} \times \mathbf{W})$$$.
  Then, we can generate all combinations in $$$O(\mathbf{N}^{\mathbf{W}})$$$.
</p>
<p>
  For a particular combination $$$A$$$, we can check if it is a palindrome by
  simply iterating over the array and verifying that $$$A_i = A_{\mathbf{W} - i + 1}$$$
  for all $$$i = 1$$$ to $$$\frac{W}{2}$$$ in $$$O(\mathbf{W})$$$.
</p>
<p>
  If $$$A$$$ is verified to be a palindrome, we can find the minimum cost of
  achieving the combination by summing over the minimum cost of converting each
  $$$\mathbf{X}_i$$$ to $$$A_i$$$. For each $$$i$$$, we can perform a process similar
  to the combination generation process by starting with $$$\mathbf{X}_i$$$ and
  simulating successive forward operations (that is keep adding $$$\mathbf{D}$$$) or by
  simulating successive backward operations (that is keep subtracting $$$\mathbf{D}$$$) till
  we reach $$$A_i$$$. We take the minimum of the number of forward or backward
  operations as the minimum number of operations it will take to achieve the
  conversion. For each index $$$i$$$, we can hence find out the cost in
  $$$O(\mathbf{N})$$$. Therefore, the cost for all $$$\mathbf{W}$$$ wheels can be calculated in
  $$$O(\mathbf{N} \times \mathbf{W})$$$ time.
</p>
<p>
  <b>Thus, the overall time complexity:</b> $$$O(\mathbf{N}^{\mathbf{W}} \times \mathbf{W} \times
  \mathbf{N})$$$
</p>

<h3>Test Set 2</h3>

<p>
  The above brute force of generating all possible combinations approach is not
  feasible to pass test set 2 constraints. Instead for each pair $$$(\mathbf{X}_i,
  \mathbf{X}_{\mathbf{W} - i + 1})$$$ in the array $$$\mathbf{X}$$$ (for all $$$i = 1$$$ to
  $$$\frac{\mathbf{W}}{2}$$$) that need to be equalized to make the array a palindrome,
  we calculate the minimum number of operations that can do so.
</p>
<p>
  Before we move forward, we transpose the set of possible values for each wheel
  from $$$[1 \cdots \mathbf{N}]$$$ to $$$[0 \cdots \mathbf{N} - 1]$$$. This will allow us to
  visualize the circular nature of operations as modulo $$$N$$$. We do this by
  simply subtracting $$$1$$$ from all elements in $$$\mathbf{X}$$$.
</p>
<p>
  With that, let us try to find the minimum operations to change $$$\mathbf{X}_i$$$ to
  $$$\mathbf{X}_{\mathbf{W} - i + 1}$$$. Say we rotate the $$$i$$$-th wheel in the positive
  direction and try to make it equal to $$$\mathbf{X}_j$$$. Let $$$x$$$ be the number
  of operations it takes to do so. With operations being circular in nature, we
  get:
</p>
<p align="center">$$$\mathbf{X}_i + \mathbf{D}x \equiv \mathbf{X}_j \pmod{\mathbf{N}}$$$</p>
<p align="center">$$$\Rightarrow \mathbf{X}_i + \mathbf{D}x + \mathbf{N}y = \mathbf{X}_j$$$</p>
<p align="center">$$$\Rightarrow \mathbf{D}x + \mathbf{N}y = \mathbf{X}_j - \mathbf{X}_i$$$</p>
<p>
  The above equation is
  <a href="https://en.wikipedia.org/wiki/Diophantine_equation" target="_blank">
    Linear Diophantine Equation</a
  >. The greatest common divisor (GCD) of two numbers $$$i$$$ and $$$j$$$ can be
  written as $$$GCD_{i,j}$$$.
</p>
<p>
  From the
  <a
    href="https://brilliant.org/wiki/extended-euclidean-algorithm/"
    target="_blank"
  >
    Extended Euclidean Algorithm</a
  >, an LDE (Linear Diophantine Equation) $$$ax + by = c$$$ has a solution only
  if $$$c$$$ divides $$$GCD_{a,b}$$$. Thus, the above equation $$$\mathbf{D}x + \mathbf{N}y =
  \mathbf{X}_j - \mathbf{X}_i$$$ will have a solution for $$$x$$$ and $$$y$$$ only if $$$\mathbf{X}_j
  - \mathbf{X}_i$$$ is divisible by $$$GCD_{\mathbf{D},\mathbf{N}}$$$. Thus, for any pair $$$(\mathbf{X}_i,
  \mathbf{X}_{\mathbf{W} - i + 1})$$$, if $$$\mathbf{X}_{\mathbf{W} - i + 1} - \mathbf{X}_i$$$ is not divisible by
  $$$GCD_{\mathbf{D}, \mathbf{N}}$$$ the answer is <code>IMPOSSIBLE</code>.
</p>
<p>
  Otherwise, we can use the
  <a
    href="https://brilliant.org/wiki/extended-euclidean-algorithm/"
    target="_blank"
  >
    Extended Euclidean Algorithm
  </a>
  to solve for one possible solution for $$$x$$$ and $$$y$$$ in $$$O(\log
  min(\mathbf{D}, \mathbf{N}))$$$. We need the minimal operations $$$x_{min}$$$, which is
  $$$(\mathbf{N} + x) \pmod{\mathbf{N}}$$$. This is because a
  <a
    href="https://en.wikipedia.org/wiki/Diophantine_equation#:~:text=Moreover%2C%20if%20(x%2C%20y)%20is%20a%20solution%2C%20then%20the%20other%20solutions%20have%20the%20form%20(x%20%2B%20kv%2C%20y%20%E2%88%92%20ku)%2C%20where%20k%20is%20an%20arbitrary%20integer%2C%20and%20u%20and%20v%20are%20the%20quotients%20of%20a%20and%20b%20(respectively)%20by%20the%20greatest%20common%20divisor%20of%20a%20and%20b."
    target="_blank"
    >general solution
  </a>
  for $$$(x, y)$$$ will be of the form $$$(x + k \frac{\mathbf{N}}{GCD_{\mathbf{D},\mathbf{N}}}, y -
  k \frac{\mathbf{D}}{GCD_{\mathbf{D},\mathbf{N}}})$$$, where $$$k$$$ is an arbitrary integer. From
  the above general form, we can see that the minimum number of operations
  $$$x_{min}$$$ would be in the range $$$[0, \frac{\mathbf{N}}{GCD_{\mathbf{D}, \mathbf{N}}} - 1]$$$
  (if it is larger than that, we can simply subtract $$$\frac{\mathbf{N}}{GCD_{\mathbf{D},
  \mathbf{N}}}$$$ from it to get a smaller value).
</p>
<p>
  Hence, $$$x_{min} = x \pmod{\frac{\mathbf{N}}{GCD_{\mathbf{D}, \mathbf{N}}}}$$$. Since $$$x$$$
  returned from the Extended Euclidean Algorithm can be negative, we add
  $$$\frac{\mathbf{N}}{GCD_{\mathbf{D}, \mathbf{N}}}$$$ and take modulo $$$\frac{\mathbf{N}}{GCD_{\mathbf{D},
  \mathbf{N}}}$$$ again to get $$$x_{min} = (\frac{\mathbf{N}}{GCD_{\mathbf{D}, \mathbf{N}}} + x)
  \pmod{\frac{\mathbf{N}}{GCD_{\mathbf{D}, \mathbf{N}}}}$$$. Let us call this "forward direction
  $$$x_{min}$$$" as $$$x_{forward}$$$.
</p>
<p>
  Similarly, we can find the minimum number of operations if we rotate
  $$$i$$$-th wheel in the backward direction. We get a similar equation in this
  case as well:
</p>
<p align="center">$$$\mathbf{X}_i - \mathbf{D}x \equiv \mathbf{X}_j \pmod{\mathbf{N}}$$$</p>
<p align="center">$$$\Rightarrow \mathbf{X}_i - \mathbf{D}x + \mathbf{N}y = \mathbf{X}_j$$$</p>
<p align="center">$$$\Rightarrow \mathbf{D}x - \mathbf{N}y = \mathbf{X}_i - \mathbf{X}_j$$$</p>
<p>
  We solve for $$$x_{min}$$$ for this equation in a similar fashion using the
  Extended Euclidean Algorithm as the forward case. Let us call the
  $$$x_{min}$$$ we get this time as $$$x_{backward}$$$.
</p>
<p>
  Thus, the overall minimum operations it takes to change $$$\mathbf{X}_i$$$ to
  $$$\mathbf{X}_j$$$ is $$$min(x_{forward}, x_{backward})$$$. We add together the
  minimum costs for all such pairs (that is for all $$$i = 1$$$ to $$$\mathbf{W}/2$$$)
  to get the minimum cost to make the array a palindrome.
</p>
<p>
  <b>The overall time complexity:</b> $$$O(\mathbf{W} \times \log (\mathbf{D}))$$$.
</p>

  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>


    </div>
  </body>
</html>
