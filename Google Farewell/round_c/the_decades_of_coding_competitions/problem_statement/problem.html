
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Coding Competitions Farewell Rounds - Round C</h3><h1>The Decades of Coding Competitions</h1><h3>Problem</h3>
<p>
  It has been almost $$$15$$$ years since Sphinny became the premiere programming
  contestant by
  <a href="https://codingcompetitions.withgoogle.com/codejam/round/00000000004329f6/0000000000432a81#problem" target="_blank">
  mastering the art of scheduling contests</a>. She has grown alongside Coding Competitions
  and graduated into a programming contest organizer, and her Programming Club League (PCL)
  is the most popular sport in her city.
</p><p>
  There are $$$\mathbf{N}$$$ bus stops in Sphinny's city, and $$$\mathbf{M}$$$ express bus routes. Each route
  bidirectionally connects two different bus stops, called their endpoints.
  Because of the popularity of PCL, the driver of each bus routes cheers for exactly one
  club.
</p><p>
  Sphinny has to pick up the contest materials for the $$$j$$$-th contest at bus stop $$$\mathbf{P_j}$$$
  and then the contest will be run in bus stop $$$\mathbf{C_j}$$$. She can only use the given bus routes to travel
  between them. Formally, a path for Sphinny to go
  from $$$\mathbf{P_j}$$$ to $$$\mathbf{C_j}$$$ is a list of bus routes such that each two consecutive routes
  have a common endpoint. Also the first route in the path has $$$\mathbf{P_j}$$$ as an endpoint and the
  last one has $$$\mathbf{C_j}$$$ as an endpoint. Notice that the same bus route
  can be used multiple times in a path. If Sphinny's path from $$$\mathbf{P_j}$$$ to $$$\mathbf{C_j}$$$
  contains one or more bus routes whose driver cheers for club $$$c$$$, then club $$$c$$$
  will join the contest. Otherwise, club $$$c$$$ will not join the contest.
  For organizational reasons, Sphinny needs the number of
  clubs in each contest to be an odd number.
</p><p>
  Given the layout of Sphinny's city's bus routes and the contests' details, 
  find out for how many contests there exists a path for Sphinny to take that can ensure
  an odd number of clubs joining it.
</p>

<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, $$$\mathbf{T}$$$. $$$\mathbf{T}$$$ test
  cases follow.<br />
  The first line of each test case contains three integers $$$\mathbf{N}$$$, $$$\mathbf{M}$$$, and $$$\mathbf{Q}$$$:
  the number of bus stops, bus routes, and contests, respectively.<br />
</p><p>
  Then, $$$\mathbf{M}$$$ lines follow representing a different bus route each.
  The $$$i$$$-th of these lines contains three integers $$$\mathbf{U_i}$$$, $$$\mathbf{V_i}$$$, and $$$\mathbf{K_i}$$$, meaning
  that the $$$i$$$-th bus route connects bus stops $$$\mathbf{U_i}$$$ and $$$\mathbf{V_i}$$$ and its driver cheers for club
  $$$\mathbf{K_i}$$$.
</p><p>
  Finally, the last $$$\mathbf{Q}$$$ lines represent a contest each. The $$$j$$$-th of these lines
  contains two integers $$$\mathbf{P_j}$$$ and $$$\mathbf{C_j}$$$, representing that materials for the $$$j$$$-th contest
  need to be picked up at bus stop $$$\mathbf{P_j}$$$ and the contest needs to be run at bus stop $$$\mathbf{C_j}$$$.
</p>

<h3>Output</h3>
<p>
  For each test case, output one line containing
  <code>Case #$$$x$$$: $$$y$$$</code>, where $$$x$$$ is the test case number
  (starting from 1) and $$$y$$$ is the number of contests for which Sphinny can find a path
  that ensures an odd number of clubs join it.
</p>

<h3>Limits</h3>
<p>
Memory limit: 2 GB.<br/>

  $$$1 \le \mathbf{T} \le 100$$$.<br />
  $$$1 \le \mathbf{U_i} \le \mathbf{N}$$$, for all $$$i$$$.<br />
  $$$1 \le \mathbf{V_i} \le \mathbf{N}$$$, for all $$$i$$$.<br />
  $$$\mathbf{U_i} \neq \mathbf{V_i}$$$, for all $$$i$$$<br />
  $$$(\mathbf{U_i}, \mathbf{V_i}) \neq (\mathbf{U_j}, \mathbf{V_j})$$$ and $$$(\mathbf{U_i}, \mathbf{V_i}) \neq (\mathbf{V_j}, \mathbf{U_j})$$$,
  for all $$$i \neq j$$$. (No two bus routes
  have the same pair of endpoints.)<br />
  $$$1 \le \mathbf{P_j} \le \mathbf{N}$$$, for all $$$j$$$.<br />
  $$$1 \le \mathbf{C_j} \le \mathbf{N}$$$, for all $$$j$$$.<br />
  $$$\mathbf{P_j} \neq \mathbf{C_j}$$$, for all $$$j$$$.<br />
</p>

<h4>Test Set 1 (Visible Verdict)</h4>
<p>
Time limit: 20 seconds.<br/>

  $$$2 \le \mathbf{N} \le 500$$$.<br />
  $$$1 \le \mathbf{M} \le 500$$$.<br />
  $$$1 \le \mathbf{Q} \le 500$$$.<br />
  $$$1 \le \mathbf{K_j} \le 2$$$, for all $$$j$$$.<br />
</p>

<h4>Test Set 2 (Visible Verdict)</h4>
<p>
Time limit: 40 seconds.<br/>

  $$$2 \le \mathbf{N} \le 500$$$.<br />
  $$$1 \le \mathbf{M} \le 500$$$.<br />
  $$$1 \le \mathbf{Q} \le 500$$$.<br />
  $$$1 \le \mathbf{K_j} \le 100$$$, for all $$$j$$$.<br />
</p>

<h4>Test Set 3 (Hidden Verdict)</h4>
<p>
Time limit: 120 seconds.<br/>

  $$$2 \le \mathbf{N} \le 10000$$$.<br />
  $$$1 \le \mathbf{M} \le 10000$$$.<br />
  $$$1 \le \mathbf{Q} \le 10000$$$.<br />
  $$$1 \le \mathbf{K_j} \le 100$$$, for all $$$j$$$.<br />
</p>


  <h3>Sample</h3>
  <i>
    Note: there are additional samples that are not run on submissions down below.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="the_decades_of_coding_competitions_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">2
5 5 3
1 2 1
2 3 2
2 4 1
2 5 1
4 5 1
1 3
3 4
5 1
3 1 2
1 3 1
1 2
1 3
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="the_decades_of_coding_competitions_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 1
Case #2: 1
</pre>
        </div>
      </div>
    </div>
  </div>

<p align="center">
  <img src="images/example1.png" alt="ex1" class="center" width="95%" /><br />
</p>
<p>
  Sample Case #1 is pictured above. In the first two contests, both clubs (green and blue)
  must be involved in it no matter what path is chosen. For the last contest, it is possible
  to involve only the green club by using the path through bus stops $$$1, 2, 4, 5$$$.
</p>
<p>
  For Sample Case #2, the first contest is not possible because there is no path to go from
  bus stop $$$1$$$ to bus stop $$$2$$$. For the second contest, there is a path including the
  only bus route going bus stop $$$1$$$ to bus stop $$$3$$$, therefore yielding a contest
  involving exactly $$$1$$$ club, which is an acceptable odd number of clubs.
</p>


  <br/>
  <h3>Additional Sample - Test Set 2</h3>
  <i>
    The following additional sample fits the limits of Test Set 2. It will not
    be run against your submitted solutions.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="the_decades_of_coding_competitions_sample_ts2_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_1">1
4 5 2
1 2 3
1 3 3
3 4 7
2 3 3
2 4 6
1 2
1 4
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="the_decades_of_coding_competitions_sample_ts2_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_1">Case #1: 2
</pre>
        </div>
      </div>
    </div>
  </div>

<p align="center">
  <img src="images/example2.png" alt="ex2" class="center" width="95%" /><br />
</p>
<p>
  This additional Sample Case is pictured above. In this case, both contests can be done with
  an odd number of clubs. An example path that achieves that is shown in the picture.
</p>

    </div>
  </body>
</html>
