
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2020 - Round 2</h3><h1>Wormhole in One</h1><h3>Problem</h3>
<p>
  You are participating in an inter-galactic hyperspace golf competition, and
  you have advanced to the final round! You are really determined to triumph,
  and so you want to prepare a winning strategy.
</p><p>
  In hyperspace golf, just as in conventional golf, you hit a ball with a
  club, which sends the ball in a direction chosen by you. The playing field in
  hyperspace golf is a 2-dimensional plane with points representing the
  different holes. The ball is also represented by a point, and you get to
  choose where the ball starts, as long as it is not in the same place as a
  hole.
</p><p>
  Since this is hyperspace golf, the players are allowed to turn some pairs of
  holes into wormholes by linking them together. Each hole can be either left
  as a normal hole, or linked to at most one other hole (never to itself).
  Wormholes are undirected links, and can be traversed in either direction.
</p><p>
  Because the environment is frictionless, when you hit the ball, it moves in
  a straight direction that it maintains forever unless it reaches a hole;
  call that hole h. Upon touching hole h, the ball stops if h is not connected
  to another hole. If h is connected to another hole h', then the ball
  immediately comes out of h' and continues moving in the same direction as
  before.
</p><p>
  You know the location of each hole. You want to maximize the number of
  distinct holes you can touch with a single hit. With that goal in mind, you
  want to pick the ball's starting location, the direction in which to send
  the ball, and which pairs of holes, if any, to link together as wormholes.
  The ball cannot start in the same place as a wormhole.
  When the ball goes through a wormhole, both the hole it goes into and the
  hole it comes out of are counted towards your total. Each hole is only
  counted once, even if the ball goes into it or comes out of it (or both)
  multiple times. If the ball stops in a hole, that hole also counts toward
  your total.
</p>
<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, <b>T</b>.
  <b>T</b> test cases follow. Each case begins with one line containing a
  single integer <b>N</b>: the total number of holes. The following <b>N</b>
  lines contain two integers each: <b>X<sub>i</sub></b> and
  <b>Y<sub>i</sub></b>, representing the X and Y coordinates, respectively, of
  the i-th hole.
</p>

<h3>Output</h3>
<p>
  For each test case, output one line containing Case #x: y, where x is
  the test case number (starting from 1) and y is the maximum number of distinct holes
  you can touch if you make optimal decisions as described above.
</p>

<h3>Limits</h3>
<p>
  Time limit: 30 seconds per test set.<br/>
  Memory limit: 1GB.<br/>
  1 &le; <b>T</b> &le; 100.<br/>
  -10<sup>9</sup> &le; <b>X<sub>i</sub></b> &le; 10<sup>9</sup>, for all
  i.<br/>
  -10<sup>9</sup> &le; <b>Y<sub>i</sub></b> &le; 10<sup>9</sup>, for all
  i.<br/>
  (<b>X<sub>i</sub></b>, <b>Y<sub>i</sub></b>) &ne; (<b>X<sub>j</sub></b>, <b>Y<sub>j</sub></b>),
    for all i &ne; j. (No two holes are at the same coordinates.)<br/>
</p>

<h4>Test Set 1 (Visible Verdict)</h4>
<p>
  1 &le; <b>N</b> &le; 7.<br/>
</p>

<h4>Test Set 2 (Hidden Verdict)</h4>
<p>
  1 &le; <b>N</b> &le; 100.<br/>
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="wormhole_in_one_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">5
2
0 0
5 5
3
0 0
5 5
5 0
5
0 0
5 5
5 0
3 2
2 4
7
0 0
1 1
2 1
3 1
8 2
11 2
14 2
1
-1000000000 1000000000
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="wormhole_in_one_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 2
Case #2: 3
Case #3: 4
Case #4: 7
Case #5: 1
</pre>
        </div>
      </div>
    </div>
  </div>

<p>
  In Sample Case #1, we can connect the two holes with a wormhole so that we
  could touch both of them by sending the ball into either one. Notice that
  without the wormhole, the ball would just stay in the first hole it touches,
  so it would be impossible to touch more than one hole.
</p>
<p align="center">
  <img src="images/sample_case_1.svg"/>
</p>
<p>
  In Sample Case #2, we can connect the holes at (0, 0) and at (5, 5). We can
  then hit the ball from position (4.9, 5), for example, in the positive horizontal direction
  so that it first touches the hole at (5, 5). It goes into that hole and comes out of the
  hole at (0, 0), retaining its positive horizontal direction of movement. Finally, it
  touches the hole at (5, 0), and stops (since there is no wormhole linked to that hole).
</p>
<p align="center">
  <img src="images/sample_case_2.svg"/>
</p>
<p>
  In Sample Case #3, we can connect the pair of holes at positions (0, 0) and
  (5, 0), and also the pair of holes at positions (3, 2) and (5, 5). Hitting
  the ball from (4, -1) towards the hole at (5, 0) makes it touch the holes at
  positions (5, 0), (0, 0), (5, 5) and (3, 2), in that order.
</p>
<p align="center">
  <img src="images/sample_case_3.svg"/>
</p>
<p>
  In Sample Case #4, we can connect the pairs of holes at positions (0, 0) and
  (1, 1), the pair of holes at positions (2, 1) and (11, 2), and also the pair of holes
  at positions (8, 2) and (14, 2). Hitting
  the ball from (-1, 0) towards the hole at (0, 0) makes it touch the holes at the following
  positions, in this order: (0, 0), (1, 1), (2, 1), (11, 2), (14, 2), (8, 2), (11, 2), (2, 1),
  and (3, 1). Note that although the holes at positions
  (11, 2) and (2, 1) are touched twice, they are only counted once each for the answer,
  since the problem asks for a count of distinct holes.
</p>
<p align="center">
  <img src="images/sample_case_4.svg"/>
</p>
<p>
  In Sample Case #5, there is only one hole, and we can hit the ball into it
  without needing to consider wormholes at all. (For what it's worth, we can
  choose any starting location we want, even outside of the allowable range of
  coordinates for holes.)
</p>
<p align="center">
  <img src="images/sample_case_5.svg"/>
</p>

    </div>
  </body>
</html>
