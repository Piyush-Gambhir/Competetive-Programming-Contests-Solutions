
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2020 - Round 1C</h3><h1>Analysis: Overrandomized</h1><h3>Test Set 1</h3>
<p>
In Test Set 1, the range for possible M values is so small compared to the number of records
that each combination (M<sub>i</sub>, N<sub>i</sub>) has a somewhat large probability
1 / (99 &times; M<sub>i</sub>) of appearing as a particular record, and an even larger probability
of being present as at least one record.
</p><p>
Suppose there exists at least one record with M<sub>i</sub> = N<sub>i</sub> = x for each x in
the range 1 through 9. From the record with M<sub>i</sub> = N<sub>i</sub> = 1 we know that the
only letter in <b>R<sub>i</sub></b> represents 1. Then, from all the records with
M<sub>i</sub> = 2, we can discard the ones where <b>R<sub>i</sub></b> represents 1. The leftovers
must be the ones with M<sub>i</sub> = N<sub>i</sub> = 2, and in those, the only letter in
<b>R<sub>i</sub></b> represents 2. In general, after we have decoded the letters for 1 through x,
we can take the records with M<sub>i</sub> = x + 1 and discard the ones with letters in
<b>R<sub>i</sub></b> that are already assigned, and the <b>R<sub>i</sub></b> values of the
remaining records will contain the letter that should be assigned to x + 1. Finally, the only
remaining unassigned letter should be assigned to 0.
</p><p>
This process works as long as records with M<sub>i</sub> = N<sub>i</sub> = x exist
for each x in the range 1 through 9. The probability of that happening is hard to calculate, but
the least likely of those combinations is M<sub>i</sub> = N<sub>i</sub> = 9, with a probability of
only 1 / (99 &times; 9) per record. The probability of that appearing at least once in 10000
records is greater than 99.999%. The smaller values of x have even higher probability. Of course, the
probability of all 9 coexisting is smaller than that, and the probability of that happening in all
10 cases is even smaller, but still decent enough. In addition, there is a really small probability
that the letter representing 0 doesn't appear at all in the input, but if that were the case, no
algorithm could find it. Given that this is a Visible Verdict test set, we can give the solution a
try, and confirm that it passes.
</p><p>
There are additional heuristics we could add to the algorithm. For example, if we can't find the
value for 9 in this way and we need to distinguish the two remaining letters to assign to 9 and 0,
just having a record whose <b>R<sub>i</sub></b> starts with one of the letters is enough to know
that that one should be a 9, since 0 cannot be a leading digit. This further increases the
probability of the method working. We can add more and more heuristics to cover the remaining
cases, but at some point it's easier to just try something more general.
</p>
<h3>Test Set 2</h3>
<p>
In Test Set 2, the probability of M<sub>i</sub> being a single digit is small, and we cannot
rely on that happening, let alone several times and with extra conditions. However, we can treat
records that have M<sub>i</sub> and <b>R<sub>i</sub></b> of the same length similarly, by simply
using their first letters and then using those (digit, letter) pairs as we did in the solution for
Test Set 1.
</p>
<h3>Test Set 3</h3>
<p>
At this point, it seems like we may have to throw all of the above insights away, because they are
all predicated on knowing M<sub>i</sub>. However, the "use the leading digit/letter" insight we
used to solve Test Set 2 is actually the first step toward solving Test Set 3 as well.
</p><p>
In Test Set 3, each record's information comes from a single integer, not two, so we cannot use
the association between the two parts as before. We can start by checking the distribution used
to generate the only piece of information we have. The probability of any particular N<sub>i</sub>
being equal to x is the sum of 10<sup>-16</sup> / y for y in [x, 10<sup>16</sup> - 1], which
can be approximated by 10<sup>-16</sup> (ln 10<sup>16</sup> - ln x). In other words, the
probability is decreasing in x. Because of this, leading digits are more likely to be smaller
than larger. Moreover, even though the decrease in probability between the actual result being
x and x + 1 is small, the decrease in probability between the leading digit being d and d + 1 is
large, because it aggregates the differences between the probability of dS being more than
the probability of (d+1)S for each possible suffix S.  This is a version of
<a href="https://en.wikipedia.org/wiki/Benford%27s_law" target="_blank">Benford's law</a>.
</p><p>
Therefore, a possible solution is to calculate the frequency with which each letter appears as a
leading digit, and assign the highest frequency to 1, the second highest to 2, etc. The only letter
that never appears as a leading digit, and therefore has the minimum frequency, should be assigned
to the digit 0.
</p>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>



    </div>
  </body>
</html>
