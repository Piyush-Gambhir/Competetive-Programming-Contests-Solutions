
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2020 - Round 1C</h3><h1>Overexcited Fan</h1><h3>Problem</h3>
<p>
  Today <i>will</i> be the day&mdash;today will be the day that you finally
  get a picture with Peppurr the cat!
</p><p>
  It has just been announced that Peppurr will be touring your city. The city has infinitely
  many infinitely-long streets running north-south and infinitely many infinitely-long streets
  running east-west. An intersection is any point at which a north-south street and an
  east-west street meet. From any given intersection, the closest intersection in each of the
  four directions (north, east, south and west) is exactly one block away.
</p><p>
  You know the exact path that Peppurr's tour will take along those streets.
  Your goal is to be at one of the intersections on Peppurr's tour at the same time that
  Peppurr is there, and you want to do so as fast as possible. This is how you will
  get your picture with Peppurr!
</p><p>
  Peppurr's tour starts at an intersection that is <b>X</b> blocks east and <b>Y</b>
  blocks north of the intersection where you are currently located. Both you and Peppurr
  take exactly one minute to walk one full block, and must finish each minute at an
  intersection; neither of you can walk partial blocks.
</p><p>
  Peppurr moves along a predefined path. Every minute, you can
  choose to stand still for the minute, or use it to walk a single block in any of
  the 4 directions (north, east, south or west). Both you and Peppurr only walk along the
  streets.
</p><p>
  If you and Peppurr are at the same intersection at the same time, you can take
  a picture, even at the last intersection of the tour. However, Peppurr is unavailable
  for pictures after the tour ends, so arriving at the tour's final intersection
  even a single minute after the tour finishes means you will not get a picture.
</p><p>
  Is it possible to get a picture with Peppurr? If so, how soon can you do it?
</p>

<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, <b>T</b>.
  <b>T</b> test cases follow. Each case consists of one line containing two
  integers, <b>X</b> and <b>Y</b>, and a string of characters <b>M</b>.
  This represents that Peppurr's tour starts exactly <b>X</b> blocks east
  and <b>Y</b> blocks north of you. The string <b>M</b> is the sequence
  of moves that Peppurr will make.
  The i-th character in <b>M</b> is one of <code>N</code>,
  <code>E</code>, <code>S</code> or <code>W</code>, and corresponds to the
  direction (north, east, south, or west, respectively) in which Peppurr will
  walk one block during the tour's i-th minute.
</p>

<h3>Output</h3>
<p>
  For each test case, output one line with <code>Case #x: y</code>, where
  <code>x</code> is the test case number (starting from 1). If there is no way
  to get a picture with Peppurr, <code>y</code> is <code>IMPOSSIBLE</code>. Otherwise,
  <code>y</code> is the smallest number of minutes from the start of the tour needed
  to get a picture with Peppurr.
</p>

<h3>Limits</h3>
<p>
  1 &le; <b>T</b> &le; 100.<br/>
  Time limit: 20 seconds per test set.<br/>
  Memory limit: 1GB.<br/>
  (<b>X</b>, <b>Y</b>) &ne; (0, 0). (The tour does not start in the same intersection as you.)<br/>
</p>

<h4>Test Set 1 (Visible Verdict)</h4>
<p>
  0 &le; <b>X</b> &le; 10.<br/>
  0 &le; <b>Y</b> &le; 10.<br/>
  1 &le; length of <b>M</b> &le; 8.<br/>
  Each character in <b>M</b> is an uppercase letter &mdash;
      either <code>N</code> or <code>S</code>.<br/>
</p>

<h4>Test Set 2 (Visible Verdict)</h4>
<p>
  0 &le; <b>X</b> &le; 1000.<br/>
  0 &le; <b>Y</b> &le; 1000.<br/>
  1 &le; length of <b>M</b> &le; 1000.<br/>
  Each character in <b>M</b> is an uppercase letter &mdash;
      either <code>N</code> or <code>S</code>.<br/>
</p>

<h4>Test Set 3 (Visible Verdict)</h4>
<p>
  0 &le; <b>X</b> &le; 1000.<br/>
  0 &le; <b>Y</b> &le; 1000.<br/>
  1 &le; length of <b>M</b> &le; 1000.<br/>
  Each character in <b>M</b> is an uppercase letter &mdash;
      either <code>N</code>, <code>E</code>, <code>S</code> or <code>W</code>.<br/>
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="overexcited_fan_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">5
4 4 SSSS
3 0 SNSS
2 10 NSNNSN
0 1 S
2 7 SSSSSSSS
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="overexcited_fan_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 4
Case #2: IMPOSSIBLE
Case #3: IMPOSSIBLE
Case #4: 1
Case #5: 5
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  In Sample Case #1, you can walk east four blocks and you will be able to take a picture
  with Peppurr on the tour's last intersection.
</p><p>
  In Sample Case #2, the tour starts off exactly three blocks to the east of you. No matter how
  you move, you cannot get a picture with Peppurr.
</p><p>
  In Sample Case #3, the tour is too far north for you to get the picture before the tour ends.
</p><p>
  In Sample Case #4, the tour will come to you after one minute, so you don't even have to move!
  Enjoy the picture with Peppurr! Remember that you can only take pictures in intersections,
  so if you moved north while the tour moved south, which would cause you to cross paths
  with Peppurr outside of an intersection, you could not get your picture in 0.5 minutes.
</p><p>
  In Sample Case #5, you can move north twice, then east twice. Then, you can stay still
  and you will be able to take a picture with Peppurr in the next minute. There are other
  paths you can take which can get you a picture with Peppurr in 5 minutes, but none which
  can do it sooner than that.
</p><p>
  The following two cases could not appear in Test Set 1 or Test Set 2, but could appear in Test
  Set 3:
</p>
<pre>
2
3 2 SSSW
4 0 NESW
</pre>
<p>
  The correct output for these two cases would be:
</p>
<pre>
Case #1: 4
Case #2: 4
</pre>
<p>
  Note that in Case #1, you can take a picture with Peppurr one block to the south
  and two blocks to the east of your original starting point.
</p><p>
  In Case #2, Peppurr travels in a small square. You can take a picture when Peppurr
  returns to the starting point of that square.
</p>

    </div>
  </body>
</html>
