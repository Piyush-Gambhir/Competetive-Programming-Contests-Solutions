
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2011 - World Finals</h3><h1>Google Royale</h1><h3>Problem</h3>
<p>
While visiting the planet Theta VIII, your team of space explorers is forced to participate in the plot of a badly-written book, which takes place in a hotel/casino called the <i>Google Royale</i>.  In order to escape the Royale, you will have to make enough money from gambling that you can buy the hotel for <b>V</b> dollars and leave.
</p>
<p>
You start with <b>A</b> dollars, and you will participate in <i>betting rounds</i> until one of two conditions is met.  If you finish any betting round with &le; 0 dollars, you will lose; if you finish a betting round with &ge; <b>V</b> dollars, you will buy the hotel and leave.  Otherwise you'll keep starting new betting rounds.
</p>
<p>
Each betting round consists of one or more coin flips. If you have X dollars at the start of the round, you can choose any integer <code>B</code> between 1 and <code>min(X, <b>M</b>)</code> to bet on the first coin flip.
</p>
<p>
With probability 50%, you win the coin flip, and the Royale immediately pays you <code>B</code> dollars.  You now have <code><nobr>X + B</nobr></code> dollars, and the betting round ends.
</p>
<p>
With probability 50%, you lose the coin flip and owe the Royale <code>B</code> dollars. You can now pay the <code>B</code> dollars you owe and end the round.  Or if <nobr><code>2B &le; M</code></nobr>, you can instead delay the payment and do a second coin flip with twice the bet: <code>2B</code> dollars.  If you lose again, then you owe the Royale <code>B+2B=3B</code> dollars.  You can continue doubling your bet in this way to <code>4B</code>, <code>8B</code>, etc., until either you win a coin flip, you choose to stop, or your next bet would exceed <b>M</b>. You can even continue if the total of all your bets in the current betting round exceeds <code>X</code>.
</p>
<p>
Once the round is over, you must pay the Royale for each coin flip you lost, and if you won a coin flip, the Royale pays you for that. For example, if you start with a bet of 1 dollars, lose three coin flips, and then win one, you would gain $8 - $4 - $2 - $1 = $1. If you lose three coin flips and then stopped, you would lose $4 + $2 + $1 = $7. If you are left with $0 or less after paying, then you are broke, and you have just lost the game.
</p>
<p>
Luckily you have brought an android with you, and he is able to compute the probability that you will win if you follow an optimal strategy.  What is that probability,  and what is the largest possible first bet you could make to have that probability? Remember that you are not allowed to bet more than <b>M</b>!</p>

<h3>Example</h3>
<p>
Suppose that you decide to use the following (sub-optimal) strategy. You have <b><code>A</code></b>=5 dollars; <code><b>M</b>=20</code> and <code>V=40</code>.  The following sequence of events is possible:
<ul>
<li>Round 1: You can start by betting 1, 2, 3, 4 or 5 dollars.  You decide to begin a betting round by betting 2 dollars.
<ul><li>Step 1 (B=$2): You win the first coin flip.  You gain 2 dollars, and the betting round ends.  Now you have 7 dollars.</li></ul>
</li>
<li>Round 2: You begin a betting round by betting 5 dollars.
<ul><li>Step 1 (B=$5): You lose the first coin flip.  Now you owe the Royale 5 dollars.  Since <code>5*2 &le; 20</code>, you may do another coin flip with a bet of <code>5*2=10</code> dollars.  You choose not to.  You lose 5 dollars, and the betting round ends.  Now you have 2 dollars.</li></ul>
</li>
<li>Round 3: You begin a betting round by betting 2 dollars.
<ul>
<li>Step 1 (B=$2): You lose.  Now you owe the Royale 2 dollars.  You choose to flip another coin with a bet of 4 dollars.</li>
<li>Step 2 (B=$4): You lose.  Now you owe the Royale a total of 6 dollars.  That's more than you have, which is okay.  You choose to flip another coin with a bet of 8 dollars.</li>
<li>Step 3 (B=$8): You win.  You gain 8 dollars, pay the 2+4=6 dollars you owe, and the betting round ends.  Now you have 4 dollars.</li>
</ul>
</li>
<li>Round 4: You begin a betting round by betting 2 dollars.
<ul>
<li>Step 1 (B=$2): You lose.  Now you owe the Royale 2 dollars.  You choose to flip another coin with a bet of 4 dollars.</li>
<li>Step 2 (B=$4): You lose.  Now you owe the Royale a total of 6 dollars.  You choose to flip another coin with a bet of 8 dollars.</li>
<li>Step 3 (B=$8): You lose.  Now you owe the Royale a total of 14 dollars.  You choose to flip another coin with a bet of 16 dollars.</li>
<li>Step 4 (B=$16): You lose.  Now you owe the Royale a total of 30 dollars.  Since <code>2*16&gt;<b>M</b></code>, you cannot flip another coin and you must pay what you owe.  Now you have -26 dollars; you have lost.</li>
</ul>
</li>
</ul>

<h3>Input</h3>
<p>
The first line of the input gives the number of test cases, <b>T</b>.  <b>T</b> lines follow.  Each line contains three integers separated by single spaces: <b>A</b>, <b>M</b> and <b>V</b>, in that order.
</p>

<h3>Output</h3>
<p>
For each test case, output one line containing "Case #x: y z", where <b>x</b> is the case number (starting from 1); <b>y</b> is the probability of winning if you follow an optimal strategy; and <b>z</b> is the maximum first bet you can make without reducing your probability of winning.  <b>y</b> must be correct to within an absolute or relative error of 10<sup>-6</sup>.
</p>

<h3>Limits</h3>
<p>
1 &le; <b>T</b> &le; 100.<br/>
Memory limit: 1GB.
</p>

<h4>Small dataset (Test set 1 - Visible)</h4>
<p>
1 &le; <b>M</b> &le; 20.<br/>
1 &le; <b>A</b> &lt; <b>V</b> &le; 20.<br/>
Time limit: 30 seconds.
</p>

<h4>Large dataset (Test set 2 - Hidden)</h4>
<p>
1 &le; <b>M</b> &le; 10<sup>16</sup>.<br/>
1 &le; <b>A</b> &lt; <b>V</b> &le; 10<sup>16</sup>.<br/>
Time limit: 60 seconds.
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="google_royale_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">4
1 1 3
3 6 12
4 20 15
13 6 20
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="google_royale_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 0.333333333 1
Case #2: 0.500000000 3
Case #3: 0.755555555 3
Case #4: 0.730769231 6
</pre>
        </div>
      </div>
    </div>
  </div>
</sampleio>

    </div>
  </body>
</html>
