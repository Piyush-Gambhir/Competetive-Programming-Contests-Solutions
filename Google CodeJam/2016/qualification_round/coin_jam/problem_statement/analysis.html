
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2016 - Qualification Round</h3><h1>Analysis: Coin Jam</h1><p>
One approach here is to enumerate strings of length <b>N</b> and see if they
are jamcoins. To iterate over potential jamcoins, we can iterate over the
base-2 interpretations (odd numbers between 2<sup><b>N</b>-1</sup>+1 and
2<sup><b>N</b></sup>-1, inclusive) and use a recursive method to convert these
to different bases.
</p><p>
For the Small dataset, it is sufficient to use
<a href="https://en.wikipedia.org/wiki/Trial_division">trial division</a> to
find factors of potential jamcoins. Concretely, we can look for a nontrivial
divisor of an integer <i>k</i> by testing divisibility of every integer in
increasing order from 2 to the square root of <i>k</i>, inclusive and stopping
if we find one. Searching past the square root of the number is not needed as
if <i>k</i> has some nontrivial divisor <i>d</i>, then <i>k / d</i> is also a
non-trivial divisor and the smaller of <i>d</i> and <i>k / d</i> is at most the
square root of <i>k</i>. A sample implementation of this in C++ looks like this:
</p>
<pre><code>long long convertBinaryToBase(int x, int base) {
  // Some languages have built-ins which make this easy.
  // For example, in Python, we can avoid recursion and
  // just return int(bin(x)[2:], base)
  if (x == 0)
    return 0;
  return base * convertBinaryToBase(x / 2, base) + (x % 2);
}

long long findFactor(long long k) {
  for (long long d = 2; d * d &lt;= k; d++)
    if (k % d == 0)
      return d;
  return 0;
}

void printCoins(int N, int X) {
  for (long long i = (1 &lt;&lt; N-1) + 1; X &gt; 0; i += 2) {
    vector&lt;long long&gt; factors;
    for (int base = 2; base &lt;= 10; base++) {
      long long x = convertBinaryToBase(i, base);
      long long factor = findFactor(x);
      if (!factor)
        break;
      factors.push_back(factor);
    }
    if (factors.size() &lt; 9)
      continue;

    cout &lt;&lt; convertBinaryToBase(i, 10);
    for (long long factor : factors)
      cout &lt;&lt; " " &lt;&lt; factor;
    cout &lt;&lt; endl;
    X -= 1;
  }
}
</code></pre>
<p>
Solving the large test case may present unique challenges, depending on the
programming language used. We're given that <b>N</b> = 32, which means that in
base 10 we'll have 32-digit numbers, which we can't store in a 64-bit integer.
These numbers are also large enough that running the trial division algorithm
on a single prime would take a huge amount of time, potentially longer than the
duration of this contest! While we can solve these issues by stopping the trial
division early (say, after checking up to 1000) and using arbitrary precision
integers, there's actually a much nicer approach!
</p><p>
We can make some observations about jamcoins if we look at the output to the
Small dataset from our program above. Considering the first 50 jamcoins of
length 16, we find that 18 of them have divisors "3 2 3 2 7 2 3 2 3" and 11 of
them have divisors "3 2 5 2 7 2 3 2 11". What's the pattern in these numbers?
The numbers 5, 7, 11 from the second list provide a useful hint: they're one
more than their respective bases. Giving this some thought, we can notice that
the second list of divisors is formed by taking the smallest prime factor of
<i>b</i>+1 for each base <i>b</i>. This suggests that <i>b</i>+1 is always a
divisor for each of these 11 jamcoins, and we can easily verify that this is true.
Understanding the other common divisor list is left as an exercise for the
reader.
</p><p>
Note that <i>b</i>+1 in base <i>b</i> is 11<sub><i>b</i></sub>. A simple test
exists to determine divisibility of 11 in base-10: a number is divisible by 11
if the sum of its digits in odd positions and the sum of its digits in even
positions differ by a multiple of 11. This
<a href="https://en.wikipedia.org/wiki/Divisibility_rule">divisibility rule</a>
for 11 can be extended to a simple rule: a string of <code>0</code>s and
<code>1</code>s which starts and ends with a <code>1</code> and has the same
number of <code>1</code>s at odd and even indices is divisible by <i>b</i>+1 when
interpreted as a base-<i>b</i> number. Such a string is therefore a jamcoin,
but not every jamcoin necessarily matches this condition. A stricter condition
that may be easier to notice is that a string of <code>0</code>s and
<code>1</code>s which starts and ends with a <code>1</code> is a jamcoin if all
<code>1</code>s are paired, i.e. it matches the regular expression
<code>11(0|11)*11</code>. For example, in any base <i>b</i>,
11011<sub><i>b</i></sub> = 1001<sub><i>b</i></sub> &times; 11<sub><i>b</i></sub>.
</p><p>
The last example here also suggests a more general rule. Consider any string
<code>p</code> of <code>0</code>s and <code>1</code>s with at least two
characters, which starts and ends with a <code>1</code>. Any string which is
<code>p</code> repeated multiple times with any number of <code>0</code>s
between repetitions is a jamcoin. In the previous example we have
<code>p</code> = <code>11</code> and this general rule can be expressed as the
regular expression <code>(1[01]*1)(0*\1)+</code>. For example, in any base <i>b</i>,
<u>11101</u>000<u>11101</u>0<u>11101</u><sub><i>b</i></sub> =
11101<sub><i>b</i></sub> &times; 100000001000001<sub><i>b</i></sub>.
</p><p>
We can use any of these rules to mine jamcoins easily. The Python 2 code below
mines jamcoins with exactly 5 pairs of <code>11</code>s, which finds enough for
both the Small and Large datasets.
</p>
<pre><code>def printCoins(N, X):
  # N digits, 10 1s, N-10 0s
  for i in range(N-10):
    for j in range(N-10-i):
      for k in range(N-10-i-j):
        l = N-10-i-j-k
        assert l &gt;= 0
        template = "11{}11{}11{}11{}11"
        output = template.format("0"*i, "0"*j, "0"*k, "0"*l)
        factors = "3 2 5 2 7 2 3 2 11"
        print output, factors
        X -= 1
        if X == 0:
          return
  # If we get here, we didn't mine enough jamcoins!
  assert False
</code></pre>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>



    </div>
  </body>
</html>
