
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2021 - Qualification Round</h3><h1>Analysis: Moons and Umbrellas</h1><h3>Test Set 1</h3>
<p>
In Test Set 1, the size of the mural is small enough that we can test every possible final mural.
Let $$$\ell$$$ be the length of $$$\mathbf{S}$$$.
We can either check for each string of length $$$\ell$$$
consisting only on <code>C</code>s and <code>J</code>s whether it agrees with
$$$\mathbf{S}$$$ in the non-<code>?</code> spots, or brute-force only the <code>?</code>s directly. For
each valid way of finishing the mural, we can calculate the total cost to Cody-Jamal, and keep
a running minimum to output at the end. Since we check at most $$$2^\ell$$$ final murals, and for
each we need only an additional linear pass to check the score, this algorithm takes
$$$O(2^\ell \cdot \ell)$$$ time, which is fast enough for Test Set 1.
</p>
<h3>Test Set 2</h3>
<p>
In Test Set 2, $$$\ell$$$ can be up to $$$1000$$$, so an exponential algorithm will not do.
However, a simple observation can yield a much faster algorithm:
since $$$\mathbf{X}$$$ > 0 and $$$\mathbf{Y}$$$ > 0, we would like to avoid inserting <code>CJ</code> or <code>JC</code>
into the string. So if all letters
surround a consecutive substring of <code>?</code>s are the same letter $$$a$$$, then making
all those <code>?</code>s into $$$a$$$ adds no <code>CJ</code>s or <code>JC</code>s.
If the substring is surrounded by $$$a$$$ on the left and $$$b$$$ on the right, with
$$$a \neq b$$$, on the other hand, at some point there will be a change from $$$a$$$ to $$$b$$$,
so we will be forced into an occurrence of $$$ab$$$. Making all the <code>?</code>s into $$$a$$$s
(or $$$b$$$s) makes sure that we only add that one forced occurrence and nothing else. This yields
a greedy algorithm that can be implemented in multiple ways, some taking as little as
$$$O(\ell)$$$ time. Notice that the cost is the same on the resulting string than on the string
where <code>?</code>s are removed instead of replaced, which leads to a 1-line implementation:
</p><pre>
S.replace('?', '').count('CJ') * X + S.replace('?', '').count('JC') * Y
</pre>
<h3>Extra credit: Test Set 3</h3>
<p>
In the solution for Test Set 2 we assume that minimizing the number of occurrences of
<code>CJ</code> and/or <code>JC</code> is best, which is true only when $$$\mathbf{X}$$$ and $$$\mathbf{Y}$$$ are
non-negative. This means that Test Set 3 needs a completely different solution. In this
case, a technique that would not normally show up in the second
problem in a Qualification Round:
<a href="https://en.wikipedia.org/wiki/Dynamic_programming" target="_blank">dynamic programming</a>.
</p><p>
We can take the function $$$f(s)$$$ that we need to compute and define it recursively as
follows:
</p><ul>
<li>$$$f(\mathtt{?}s) = \min(f(\mathtt{C}s), f(\mathtt{J}s))$$$</li>
<li>$$$f(a\mathtt{?}s) = \min(f(a\mathtt{C}s), f(a\mathtt{J}s))$$$ for
  $$$a \in \{\mathtt{C}, \mathtt{J}\}$$$</li>
<li>$$$f(aas) = f(as)$$$ for $$$a \in \{\mathtt{C}, \mathtt{J}\}$$$</li>
<li>$$$f(\mathtt{CJ}s) = \mathbf{X} + f(\mathtt{J}s)$$$</li>
<li>$$$f(\mathtt{JC}s) = \mathbf{Y} + f(\mathtt{C}s)$$$</li>
<li>$$$f(s) = 0$$$ if the length of $$$s \le 1$$$</li>
</ul><p>
You can verify that the cases above form a partition and properly define the recursion.
We have a constant number of cases, each of which can be computed in constant time not
counting the recursion calls, so the time complexity of the solution is $$$O(D)$$$ where
$$$D$$$ is the size of the domain of the function. You can check that every value of $$$f$$$
that is ever required to calculate $$$f(\mathbf{S})$$$
can be defined by a suffix of the input $$$\mathbf{S}$$$ and at most two extra characters at the beginning.
This means $$$D$$$ is linear in the length of $$$\mathbf{S}$$$, and so is the time complexity of the algorithm.
Notice that we need to represent each element in the domain in constant space for this to work
out exactly as mentioned, for example representing suffixes of $$$\mathbf{S}$$$ by just their length or an
index into $$$\mathbf{S}$$$. However, for the low limits of this problem, even a larger representation using
copies of the full suffix is fast enough.
<p>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>


    </div>
  </body>
</html>
