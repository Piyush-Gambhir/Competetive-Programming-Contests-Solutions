
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2021 - Round 1B</h3><h1>Subtransmutation</h1><h3>Problem</h3>
<p>
As the most skilled alchemist in your country, you were summoned yet again because
powers beyond science were needed to satisfy your country's leader's ever increasing
greed for rare metals.
</p><p>
Each metal is represented by a positive integer. You need to create $$$\mathbf{U_1}$$$ units of metal
$$$1$$$, $$$\mathbf{U_2}$$$ units of metal $$$2$$$, $$$\ldots$$$ and $$$\mathbf{U_N}$$$ units of metal $$$\mathbf{N}$$$. Metals
$$$\mathbf{N}+1, \mathbf{N}+2, \ldots$$$ do exist, but you are not required to create any specific amount
of them. You are allowed to create excess amounts of any metal, which can just be discarded.
</p><p>
Unfortunately, budget cuts have left you only the materials for a simple alchemy spell.
For some fixed numbers $$$\mathbf{A}$$$ and $$$\mathbf{B}$$$, with $$$\mathbf{A} \lt \mathbf{B}$$$, you can take one unit
of metal $$$i$$$ and destroy it to create one unit of metal $$$(i-\mathbf{A})$$$ and one
unit of metal $$$(i-\mathbf{B})$$$.
If either of those integers is not positive, that specific unit is not created.
In particular, if $$$i \le \mathbf{A}$$$, the spell simply destroys the unit and creates nothing.
If $$$\mathbf{A} \lt i \le \mathbf{B}$$$ the spell destroys the unit and
creates only a single unit of metal $$$(i-\mathbf{A})$$$.
</p><p>
You have been assigned an expert miner to assist you. The expert miner can fetch a single unit of
any metal you want. From that unit, you can use your spell to create other metals
and then use the spell on the resulting metals to create even more units. The picture below shows a
single unit of metal $$$4$$$ being converted into one unit of metal $$$1$$$ and two units of metal
$$$2$$$ using two spells with $$$\mathbf{A}=1$$$ and $$$\mathbf{B}=2$$$.
</p><p align="center">
<img src="img/subtransmutation.png" style="max-width:550px;" alt="A single unit of metal 4 creating one unit of metal 1 and two units of metal 2">
</p><p>
Metals represented by larger integers are heavier and more difficult to handle, so you want
to ask the expert miner for a single unit of metal represented by the smallest possible integer
that is sufficient to complete your task, or say that there is no such metal.
</p>

<h3>Input</h3>
<p>
The first line of the input gives the number of test cases, $$$\mathbf{T}$$$.
$$$\mathbf{T}$$$ test cases follow. Each test case consists of two lines. The first line of a
test case contains three integers $$$\mathbf{N}$$$, $$$\mathbf{A}$$$, and $$$\mathbf{B}$$$, representing the largest
metal number that you are required to create, and the two values that define the
available spell as described above, respectively. The second line of a test case contains
$$$\mathbf{N}$$$ integers $$$\mathbf{U_1}, \mathbf{U_2}, \ldots, \mathbf{U_N}$$$, representing the required units of
metals $$$1, 2, \ldots, \mathbf{N}$$$, respectively.
</p>

<h3>Output</h3>
<p>
For each test case, output one line containing <code>Case #$$$x$$$: $$$y$$$</code>,
where $$$x$$$ is the test case number (starting from 1) and $$$y$$$ is <code>IMPOSSIBLE</code>
if it is not possible to create all required units starting from a single unit of metal.
Otherwise, $$$y$$$ is the smallest integer that represents a metal such that one unit of it
is sufficient to create all the required units of metal.
</p>

<h3>Limits</h3>
<p>
Time limit: 30 seconds.<br/>
Memory limit: 1 GB.<br/>

$$$1 \le \mathbf{T} \le 100$$$.<br/>
$$$1 \le \mathbf{N} \le 20$$$.<br/>
$$$0 \le \mathbf{U_i} \le 20$$$, for all $$$i$$$.<br/>
$$$1 \le \mathbf{U_N}$$$.<br/>
$$$2 \le \mathbf{U_1} + \mathbf{U_2} + \cdots + \mathbf{U_N}$$$.<br/>
</p>

<h4>Test Set 1 (Visible Verdict)</h4>
<p>

$$$\mathbf{A} = 1$$$.<br/>
$$$\mathbf{B} = 2$$$.<br/>
</p>

<h4>Test Set 2 (Hidden Verdict)</h4>
<p>

$$$1 \le \mathbf{A} \lt \mathbf{B} \le 20$$$.<br/>
</p>


  <h3>Sample</h3>
  <i>
    Note: there are additional samples that are not run on submissions down below.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="subtransmutation_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">3
2 1 2
1 2
5 1 2
2 0 0 0 1
3 1 2
1 1 1
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="subtransmutation_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 4
Case #2: 6
Case #3: 5
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
In Sample Case #1, we require one unit of metal $$$1$$$ and two units of metal $$$2$$$.
If we start with a single unit of metal $$$3$$$, then applying the spell once will give us one
unit of metal $$$1$$$ and one unit of metal $$$2$$$. There is no way to get an additional
unit of metal $$$2$$$. Similarly,
starting with a single unit of metals $$$1$$$ or $$$2$$$ is not sufficient.
However, a single unit of metal $$$4$$$ is sufficient as is demonstrated in the
picture in the main part of the statement.
</p><p>
  In Sample Case #2, we can start with a single unit of metal $$$6$$$ and apply the following
  operations:
  <ul>
    <li>Apply spell on $$$6$$$: $$$\{6\} \longrightarrow \{4, 5\}$$$.</li>
    <li>Apply spell on $$$4$$$: $$$\{4, 5\} \longrightarrow \{2, 3, 5\}$$$.</li>
    <li>Apply spell on $$$2$$$: $$$\{2, 3, 5\} \longrightarrow \{1, 3, 5\}$$$.</li>
    <li>Apply spell on $$$3$$$: $$$\{1, 3, 5\} \longrightarrow \{1, 1, 2, 5\}$$$.</li>
  </ul>
  Note that even though we have an extra unit of metal $$$2$$$, this solution is valid.
</p><p>
  In Sample Case #3, we can start with a single unit of metal $$$5$$$ and apply the following
  operations:
  <ul>
    <li>Apply spell on $$$5$$$: $$$\{5\} \longrightarrow \{3, 4\}$$$.</li>
    <li>Apply spell on $$$4$$$: $$$\{3, 4\} \longrightarrow \{2, 3, 3\}$$$.</li>
    <li>Apply spell on $$$2$$$: $$$\{2, 3, 3\} \longrightarrow \{1, 3, 3\}$$$.</li>
    <li>Apply spell on $$$3$$$: $$$\{1, 3, 3\} \longrightarrow \{1, 1, 2, 3\}$$$.</li>
  </ul>
  There are other ways to apply spells which also work but they all require starting
  with a single unit of metal $$$5$$$ or higher.
</p>


  <br/>
  <h3>Additional Sample - Test Set 2</h3>
  <i>
    The following additional sample fits the limits of Test Set 2. It will not
    be run against your submitted solutions.
  </i>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="subtransmutation_sample_ts2_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_1">3
3 2 4
1 1 1
3 2 4
1 0 1
5 2 5
1 0 0 0 1
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="subtransmutation_sample_ts2_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_1').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_1');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_1">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_1">Case #1: IMPOSSIBLE
Case #2: 5
Case #3: 10
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  In the first Sample Case for Test Set 2, it is impossible to start with a single unit of any
  metal and apply the spell with $$$\mathbf{A}=2$$$ and $$$\mathbf{B}=4$$$
  several times and be left with one unit of metals $$$1$$$, $$$2$$$, and $$$3$$$.
</p>

    </div>
  </body>
</html>
