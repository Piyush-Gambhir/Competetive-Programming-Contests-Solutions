
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2021 - World Finals</h3><h1>Cutting Cake</h1><h3>Problem</h3>
<p>
Today is your and your twin sibling's birthday. To celebrate, you got a rectangular cake to share.
The cake is decorated with $$$\mathbf{N}$$$ triangular patches of icing (which may overlap). All the icing
patches were created with the same triangular mold, so they have the same shape and orientation.
Although you and your twin are very similar, your tastes in icing are much different.
This difference is formalized by each of you having a different enjoyment value for each patch of
icing. Specifically, your enjoyment value for eating the entire $$$i$$$&NoBreak;-&NoBreak;th patch
of icing is $$$\mathbf{A_i}$$$, and your twin's is $$$\mathbf{B_i}$$$. If someone eats part of a patch, they get
enjoyment proportional to the eaten area. For example, if you eat
$$$\frac{2}{3}$$$ of the area of the $$$i$$$&NoBreak;-&NoBreak;th icing patch, you would get
$$$\frac{2\mathbf{A_i}}{3}$$$ enjoyment from it.
Note that there may be some flavors of icing that you or your twin do not enjoy, so the $$$\mathbf{A_i}$$$
and/or $$$\mathbf{B_i}$$$ values can be negative.
</p>
<div align=center>
  <div style="display: inline-block; flex-direction: column; padding: 20px 0 0 0;">
    <div>
      <img src="img/cutting_cake.png" alt="A cake with 4 icing patches.">
    </div>
  </div>
</div>
<p>
You will cut the cake into two rectangular pieces by making a single vertical cut
(parallel to the Y-axis). After cutting the cake, you will eat the left piece and your twin will
eat the right piece.
Your total enjoyment is the sum of the enjoyment you get from all icing to the left of the cut.
Similarly,
your twin's enjoyment is the sum of the enjoyment they get from all icing to the right of the cut.
</p><p>
To be as fair as possible, you want to cut the cake such that
the absolute value of the difference between your total enjoyment and your twin's total enjoyment
is as small as possible.
Given the $$$\mathbf{N}$$$ triangular icing patches on a rectangular cake, what is the minimum possible
absolute value of the difference between your and your twin's total enjoyments
you can get?
</p>

<h3>Input</h3>
<p>
The first line of the input gives the number of test cases, $$$\mathbf{T}$$$. $$$\mathbf{T}$$$ test cases follow.
Each test case starts with a line containing three positive integers, $$$\mathbf{N}$$$, $$$\mathbf{W}$$$, and $$$\mathbf{H}$$$,
representing the number of icing patches on the cake and the width and height of the top of the
cake, respectively. The bottom-left corner of the cake is
located at $$$(0, 0)$$$ and the top-right corner is at $$$(\mathbf{W}, \mathbf{H})$$$.
Then, a line describing the icing patch mold follows. This line contains four integers:
$$$\mathbf{P}$$$, $$$\mathbf{Q}$$$, $$$\mathbf{R}$$$, and $$$\mathbf{S}$$$. The icing patch mold is a triangle with vertices at $$$(0, 0)$$$,
$$$(\mathbf{P}, \mathbf{Q})$$$, and $$$(\mathbf{R}, \mathbf{S})$$$.
Then, $$$\mathbf{N}$$$ lines follow. The $$$i$$$&NoBreak;-&NoBreak;th of these lines contains four integers
$$$\mathbf{X_i}$$$, $$$\mathbf{Y_i}$$$, $$$\mathbf{A_i}$$$, and $$$\mathbf{B_i}$$$. The $$$i$$$&NoBreak;-&NoBreak;th patch is a triangle with vertices
at $$$(\mathbf{X_i}, \mathbf{Y_i})$$$, $$$(\mathbf{X_i} + \mathbf{P}, \mathbf{Y_i} + \mathbf{Q})$$$,
and $$$(\mathbf{X_i} + \mathbf{R}, \mathbf{Y_i} + \mathbf{S})$$$. You would get $$$\mathbf{A_i}$$$ enjoyment from eating it and your twin
would get $$$\mathbf{B_i}$$$ enjoyment.
</p>

<h3>Output</h3>
<p>
For each test case, output one line containing <code>Case #$$$x$$$: $$$y$$$/$$$z$$$</code>,
where $$$x$$$ is the test case number (starting from 1) and $$$\frac{y}{z}$$$ is the minimum
absolute value of the difference between your and your twin's total enjoyment that can be achieved
with a single vertical cut as an irreducible fraction (that is, $$$z$$$ must be positive and of
minimum possible value).
</p>

<h3>Limits</h3>
<p>
Time limit: 45 seconds.<br/>
Memory limit: 1 GB.<br/>
</p>

<h4>Test Set 1 (Visible Verdict)</h4>
<p>

$$$1 \le \mathbf{T} \le 100$$$.<br/>
$$$1 \le \mathbf{N} \le 100$$$.<br/>
$$$3 \le \mathbf{W} \le 10^9$$$.<br/>
$$$3 \le \mathbf{H} \le 10^9$$$.<br/>
$$$-10^9 \le \mathbf{A_i} \le 10^9$$$, for all $$$i$$$.<br/>
$$$-10^9 \le \mathbf{B_i} \le 10^9$$$, for all $$$i$$$.<br/>
$$$0 \le \mathbf{P} \le 10^9$$$.<br/>
$$$-10^9 \le \mathbf{Q} \le 10^9$$$.<br/>
$$$0 \le \mathbf{R} \le 10^9$$$.<br/>
$$$-10^9 \le \mathbf{S} \le 10^9$$$.<br/>
The three vertices of the mold $$$(0, 0)$$$, $$$(\mathbf{P}, \mathbf{Q})$$$, and $$$(\mathbf{R}, \mathbf{S})$$$
  are not collinear.<br/>
The three vertices of each triangular icing patch are strictly inside the cake's borders.
Formally:<br/>
&nbsp;&nbsp;$$$1 \le \mathbf{X_i} \le \mathbf{W} - \max(\mathbf{P}, \mathbf{R}) - 1$$$, for all $$$i$$$, and<br/>
&nbsp;&nbsp;$$$\max(0, -\mathbf{Q}, -\mathbf{S}) + 1 \le \mathbf{Y_i} \le \mathbf{H} - \max(0, \mathbf{Q}, \mathbf{S}) - 1$$$, for all $$$i$$$.
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="cutting_cake_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">4
1 5 5
3 -1 2 2
1 2 -10 5
2 100000000 50000000
80000000 0 40000000 40000000
5000001 2500000 500 -501
15000000 5000000 501 -400
2 10 10
0 2 4 2
2 2 -4 5
4 6 -6 5
3 622460462 608203753
486076103 36373156 502082214 284367873
98895371 126167607 823055173 -740793281
26430289 116311281 -398612375 -223683435
46950301 278229490 766767410 -550292032
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="cutting_cake_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 5/1
Case #2: 288309900002019999899/320000000000000000
Case #3: 37/4
Case #4: 216757935773010988373334129808263414106891/187470029508637421883991794137967
</pre>
        </div>
      </div>
    </div>
  </div>

<p>
In Sample Case #1, there is a single icing patch. The optimal cut is to the left of the patch.
You will eat no icing and receive $$$0$$$ enjoyment. Your twin will eat all of the icing patch
and receive $$$5$$$ enjoyment from it.
The absolute value of the difference between your and your twin's enjoyments is $$$|0 - 5| = 5$$$.
</p>
<div align=center>
  <div style="display: inline-block; flex-direction: column; padding: 20px 60px 0 60px;">
    <div>
      <img src="img/sample_1a.png" alt="The cake in the first sample with a single icing patch.">
    </div>
  </div>
  <div style="display: inline-block; flex-direction: column; padding: 20px 60px 0 60px;">
    <div>
      <img src="img/sample_1b.png" alt="The cake in the first sample with a cut line at X = 4.5.">
    </div>
  </div>
</div>
<p>
In Sample Case #2, there are two icing patches. The optimal cut is at $$$X = 15099999.99$$$.
Notice that the numerator and denominator of the answer can get very large.
</p>
<div align=center>
  <div style="display: inline-block; flex-direction: column; padding: 20px 60px 0 60px;">
    <div>
      <img src="img/sample_2a.png" alt="The cake in the second sample with 2 icing patches.">
    </div>
  </div>
  <div style="display: inline-block; flex-direction: column; padding: 20px 60px 0 60px;">
    <div>
      <img src="img/sample_2b.png" alt="The cake in the second sample with a cut line at X = ~1.51e7.">
    </div>
  </div>
</div>
<p>
In Sample Case #3, there are two icing patches. The optimal cut is at $$$X = 4$$$. You will eat
75% of the first icing patch and receive $$$-3$$$ enjoyment from it. Your twin will eat 25% of the
first icing patch and all of the second icing patch getting $$$5 \cdot 0.25 + 5 = 6.25$$$
enjoyment. The absolute value of the difference between your and your twin's enjoyments is
$$$|-3 - 6.25| = 9.25 = \frac{37}{4}$$$.
</p><p>
Notice that cutting at $$$X = 1$$$ would give you
$$$0$$$ enjoyment and your twin $$$10$$$ enjoyment. While both of those values are greater
than the corresponding enjoyment when cutting at $$$X = 4$$$, the difference between them
is $$$10 \gt 9.25$$$, which means cutting at $$$X = 4$$$ is preferable anyway.
</p>
<div align=center>
  <div style="display: inline-block; flex-direction: column; padding: 20px 60px 0 60px;">
    <div>
      <img src="img/sample_3a.png" alt="The cake in the third sample with 2 icing patches.">
    </div>
  </div>
  <div style="display: inline-block; flex-direction: column; padding: 20px 60px 0 60px;">
    <div>
      <img src="img/sample_3b.png" alt="The cake in the third sample with a cut line at X = 4.">
    </div>
  </div>
</div>
<p>
In Sample Case #4, there are three icing patches. The optimal cut is at
$$$X \approx 521241077.6027$$$.
</p>

    </div>
  </body>
</html>
