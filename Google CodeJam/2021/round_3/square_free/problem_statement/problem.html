
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2021 - Round 3</h3><h1>Square Free</h1><h3>Problem</h3>
<p>
We have a matrix of square cells with $$$\mathbf{R}$$$ rows and $$$\mathbf{C}$$$ columns. We need to draw a diagonal in each
cell. Exactly one of two possible diagonals must be drawn in each cell: the <i>forward slash</i>
diagonal, which connects the bottom-left and the top-right corners of the cell,
or the <i>backslash</i> diagonal, which connects the top-left and the bottom-right
corners of the cell.
</p><p>
For each row and column, we want to draw a specific number of
diagonals of each type. Also, after all the diagonals are drawn, the matrix should be
<i>square free</i>. That is, there should be no squares formed using the diagonals we added.
</p><p>
For example, suppose we have a matrix with $$$4$$$ rows and $$$4$$$ columns.
The number next to each row is the exact number of forward slash diagonals there must be in
that row. The number below each column is the exact number of forward slash diagonals
there must be in that column.
</p><p align="center">
<img src="img/sample1empty.png" style="max-width:300px;" alt="An empty 4 by 4 matrix with row and column totals.">
</p><p>
There are multiple ways to fill the matrix respecting those per-row and per-column amounts.
Below we depict three possibilities:
</p>
<div align=center>
  <div style="display: inline-block; flex-direction: column; padding: 40px 60px 0 60px;">
    <div>
      <img src="img/sample1a.png" style="max-width: 300px;" alt="First way to fill the above matrix">
    </div>
  </div>
  <div style="display: inline-block; flex-direction: column; padding: 40px 60px 0 60px;">
    <div>
      <img src="img/sample1b.png" style="max-width: 300px;" alt="Second way to fill the above matrix">
    </div>
  </div>
  <div style="display: inline-block; flex-direction: column; padding: 40px 60px 0 60px;">
    <div>
      <img src="img/sample1c.png" style="max-width: 300px;" alt="Third way to fill the above matrix">
    </div>
  </div>
</div>
<p>
The first two matrices are not square free, while the third matrix is.
In the first matrix, there is a square of side-length $$$2$$$ diagonals with its vertices in the
middle of each side of the matrix. In the second matrix, there is a square of side-length $$$1$$$
diagonal drawn in the bottom-right corner. In the third matrix, there is no square.
The third matrix would then be a valid drawing according to all the rules.
</p><p>
Given the size of the matrix and the exact number of forward slash diagonals that must be drawn
in each row and column, produce any square free matrix that satisfies the row and column
constraints, or say that one does not exist.
</p>

<h3>Input</h3>
<p>
The first line of the input gives the number of test cases, $$$\mathbf{T}$$$. $$$\mathbf{T}$$$ test cases follow.
Each test case consists of exactly three lines. The first line of a test case contains
$$$\mathbf{R}$$$ and $$$\mathbf{C}$$$, the number of rows and columns of the matrix. The second line
of a test case contains $$$\mathbf{R}$$$ integers $$$\mathbf{S_1}, \mathbf{S_2}, \dots, \mathbf{S_R}$$$. $$$\mathbf{S_i}$$$
is the exact number of forward slash diagonals that
must be drawn in the $$$i$$$&NoBreak;-&NoBreak;th row from the top. The third line
of a test case contains $$$\mathbf{C}$$$ integers $$$\mathbf{D_1}, \mathbf{D_2}, \dots, \mathbf{D_C}$$$. $$$\mathbf{D_i}$$$
is the exact number of forward slash diagonals that
must be drawn in the $$$i$$$&NoBreak;-&NoBreak;th column from the left.
</p>

<h3>Output</h3>
<p>
For each test case, output one line containing <code>Case #$$$x$$$: $$$y$$$</code>,
where $$$x$$$ is the test case number (starting from 1) and $$$y$$$ is
<code>IMPOSSIBLE</code> if there is no filled matrix that follows all rules
and <code>POSSIBLE</code> otherwise. If you output <code>POSSIBLE</code>,
output $$$\mathbf{R}$$$ more lines with $$$\mathbf{C}$$$ characters each.
The $$$j$$$&NoBreak;-&NoBreak;th character of the $$$i$$$&NoBreak;-&NoBreak;th of these lines
must be <code>/</code> if the diagonal drawn in the $$$i$$$&NoBreak;-&NoBreak;th row from the top
and $$$j$$$&NoBreak;-&NoBreak;th column from the left in your proposed matrix is a forward slash
diagonal, and <code>\</code> otherwise. Your proposed matrix must be valid according to
all rules.
</p>

<h3>Limits</h3>
<p>
Time limit: 15 seconds.<br/>
Memory limit: 1 GB.<br/>

$$$1 \le \mathbf{T} \le 100$$$.<br/>
$$$0 \le \mathbf{S_i} \le \mathbf{C}$$$, for all $$$i$$$.<br/>
$$$0 \le \mathbf{D_i} \le \mathbf{R}$$$, for all $$$i$$$.<br/>
</p>

<h4>Test Set 1 (Visible Verdict)</h4>
<p>

$$$2 \le \mathbf{R} \le 6$$$.<br/>
$$$2 \le \mathbf{C} \le 6$$$.<br/>
</p>

<h4>Test Set 2 (Hidden Verdict)</h4>
<p>

$$$2 \le \mathbf{R} \le 20$$$.<br/>
$$$2 \le \mathbf{C} \le 20$$$.<br/>
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="square_free_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">4
4 4
3 2 3 3
3 3 2 3
2 3
1 1
1 1 1
2 3
1 2
1 1 1
3 3
2 0 2
2 0 2
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="square_free_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: POSSIBLE
//\/
\/\/
///\
/\//
Case #2: IMPOSSIBLE
Case #3: POSSIBLE
\\/
//\
Case #4: POSSIBLE
/\/
\\\
/\/
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  Sample Case #1 is the one explained above.
</p>
<p>
  In Sample Case #2, there must be a total of $$$2$$$ forward slash diagonals according to the
  sum of the row totals, but a total of $$$3$$$ according to the sum of the column totals. It
  is therefore impossible to follow all rules.
</p>
<p>
  In Sample Case #3 the only matrices that follow the row and column totals are the following:
</p>
<div align=center>
  <div style="display: inline-block; flex-direction: column; padding: 40px 60px 0 60px;">
    <div>
      <img src="img/sample2a.png" style="max-width: 300px;" alt="First way to fill the Sample Case 2 matrix">
    </div>
  </div>
  <div style="display: inline-block; flex-direction: column; padding: 40px 60px 0 60px;">
    <div>
      <img src="img/sample2b.png" style="max-width: 300px;" alt="Second way to fill the Sample Case 2 matrix">
    </div>
  </div>
  <div style="display: inline-block; flex-direction: column; padding: 40px 60px 0 60px;">
    <div>
      <img src="img/sample2c.png" style="max-width: 300px;" alt="Third way to fill the Sample Case 2 matrix">
    </div>
  </div>
</div>
<p>
Since the first two contain a square, the third one is the only valid output for this case.
</p><p>
  In Sample Case #4 there is only one way to fill the matrix that follows the row and column
  totals, shown in the picture below. Note that it produces a single rectangle,
  shown in blue in the picture. But, since that rectangle is not a square, the matrix is
  square free.
</p><p align="center">
<img src="img/sample4.png" style="max-width:300px;" alt="Only way to fill the Sample Case 4 matrix.">
</p>

    </div>
  </body>
</html>
