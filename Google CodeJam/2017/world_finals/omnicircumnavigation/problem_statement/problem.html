
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2017 - World Finals</h3><h1>Omnicircumnavigation</h1><h3>Problem</h3>
<p>
  Intrepid globetrotter K, who may or may not be the author of this problem,
  has been traveling a lot lately. On one of her recent trips, she traveled
  from San Francisco to Frankfurt to Johannesburg to Abu Dhabi to Singapore to
  Tokyo and back to San Francisco. On this trip, she circumnavigated the Earth
  by traveling along a closed path that touches every meridian. In other words,
  for every possible longitude, there is at least one point along this path at
  that longitude.
</p><p>
  K is not sure that this trip qualifies as being <i>super awesome</i>, however,
  since it would also be possible to circumnavigate the Earth by flying to the
  North Pole and then walking around it, which does not seem to be particularly
  difficult (other than the part about flying to the North Pole). So she has
  decided to come up with a more generalized definition of circumnavigation.
  The new concept is called <i>omnicircumnavigation</i> &mdash; a closed path
  around the Earth (which we assume to be a sphere) that is a circumnavigation
  regardless of where one places the poles. In other words, an
  omnicircumnavigation is a closed path on the surface of a sphere that touches
  every possible hemisphere. (Touching the edge of a hemisphere is sufficient.)
  Equivalently, an omnicircumnavigation intersects every possible great circle
  &mdash; a circle of greatest possible diameter on the surface of a sphere.
</p><p>
  You are given a sequence of <b>N</b> points on a sphere of radius 1. You need
  to check whether a path connecting those points in order is an
  omnicircumnavigation. The path is formed by connecting each pair of
  successive points along the shortest possible surface route, and connecting
  the last point to the first one in the same way. No two successive points
  (including the pair of the last point and the first point) are collinear with
  the origin. (That is, they are not antipodes &mdash; polar opposites &mdash;
  and they do not represent the same point on the surface of the sphere.)
</p>

<h3>Input</h3>
<p>
  The first line of the input gives the number of test cases, <b>T</b>.
  <b>T</b> test cases follow. Each begins with one line containing <b>N</b>,
  the number of cities visited by K. The next <b>N</b> lines contain three
  integers <b>X<sub>i</sub></b>, <b>Y<sub>i</sub></b> and <b>Z<sub>i</sub></b>
  each. The i-th point in the list is given by the coordinates
  (<b>X<sub>i</sub></b> /
  sqrt(<b>X<sub>i</sub></b><sup>2</sup> + <b>Y<sub>i</sub></b><sup>2</sup> +
       <b>Z<sub>i</sub></b><sup>2</sup>),
  <b>Y<sub>i</sub></b> /
  sqrt(<b>X<sub>i</sub></b><sup>2</sup> + <b>Y<sub>i</sub></b><sup>2</sup> +
       <b>Z<sub>i</sub></b><sup>2</sup>),
  <b>Z<sub>i</sub></b> /
  sqrt(<b>X<sub>i</sub></b><sup>2</sup> + <b>Y<sub>i</sub></b><sup>2</sup> +
       <b>Z<sub>i</sub></b><sup>2</sup>)).
</p>

<h3>Output</h3>
<p>
  For each test case, output one line containing <code>Case #x: y</code>,
  where <code>x</code> is the case number and <code>y</code> is either
  <code>YES</code> or <code>NO</code> depending on whether the route is an
  omnicircumnavigation or not.
</p>

<h3>Limits</h3>
<p>
Memory limit: 1 GB.<br/>
  1 &le; <b>T</b> &le; 200.<br/>
  -10<sup>6</sup> &le; <b>X<sub>i</sub></b> &le; 10<sup>6</sup>, for all i.<br/>
  -10<sup>6</sup> &le; <b>Y<sub>i</sub></b> &le; 10<sup>6</sup>, for all i.<br/>
  -10<sup>6</sup> &le; <b>Z<sub>i</sub></b> &le; 10<sup>6</sup>, for all i.<br/>
  At least one of the values in (<b>X<sub>i</sub></b>, <b>Y<sub>i</sub></b>,
  <b>Z<sub>i</sub></b>) &ne; 0, for all i.
  For all i, j such that (i + 1 = j) or (i = <b>N</b> - 1 and j = 0),
    neither of (<b>X<sub>i</sub></b>, <b>Y<sub>i</sub></b>,
    <b>Z<sub>i</sub></b>) and (<b>X<sub>j</sub></b>, <b>Y<sub>j</sub></b>,
    <b>Z<sub>j</sub></b>) is an integer multiple of the other.
    (No two successive points, including the last and first, are antipodes or
     represent the same point on the sphere.)<br/>
</p>

<h4>Small dataset (Test Set 1 - Visible)</h4>
<p>
Time limit: 60 seconds.<br/>
  3 &le; <b>N</b> &le; 50.<br/>
</p>

<h4>Large dataset (Test Set 2 - Hidden)</h4>
<p>
Time limit: 300 seconds.<br/>
  3 &le; <b>N</b> &le; 5000.<br/>
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="omnicircumnavigation_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">4
3
1 0 0
0 1 0
0 0 1
8
5 5 5
5 -5 5
-5 -5 5
-5 5 5
-5 5 -5
-5 -5 -5
5 -5 -5
5 5 -5
3
1 0 0
-1 1 0
-1 -1 0
5
1 0 0
-1 1 0
2 0 0
-2 2 0
-1 -1 0
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="omnicircumnavigation_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: NO
Case #2: YES
Case #3: YES
Case #4: YES
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  In Sample Case #1, the three points are the surface points of one octant of
  the sphere, and the path traces out that octant. There are many hemispheres
  that do not overlap that path at all.
</p><p>
  In Sample Case #2, the eight points are the corners of a cube inscribed in
  the sphere; any hemisphere will contain at least some parts of that path.
  Note that dividing all values by 5 would produce an equivalent case (with the
  same set of points).
</p><p>
  In Sample Case #3, the path is itself a great circle, and so every other
  great circle must intersect it somewhere.
</p><p>
  Sample Case #4 uses the same three points as in Sample Case #3, except that
  the first two points are visited twice each. Note that a case may include
  multiple representations of the same point, and that a path may include the
  same points or connections more than once.
</p>

    </div>
  </body>
</html>
