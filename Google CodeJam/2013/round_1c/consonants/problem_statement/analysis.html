
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2013 - Round 1C</h3><h1>Analysis: Consonants</h1><h2>Solving the small</h2>
<p>
It cannot be simpler than trying each possible substring  given the name. For a given substring, we just check if there exists <b>n</b> consecutive consonants. If it is true, we count this substring into part of the <b>n</b>-value. There are O(<b>L</b><sup>2</sup>) substrings, and it takes O(<b>L</b>) time to check for at least <b>n</b> consecutive consonants. In total each case takes O(<b>L</b><sup>3</sup>) time to solve, which is acceptable to solve the small input. This approach is, of course, not fast enough to solve the large input.
</p>
<h2>Improving the naive algorithm</h2>
<p>
In fact we can skip the linear time checking for all possible substrings. Here we assume the index is zero based. Suppose we start from the <b>i</b>-th character. We also have <b>c</b> that starts as zero. When we iterate up to the <b>j</b>-th character, if it is a consonant, we increase <b>c</b> by 1, otherwise reset it to zero. Actually <b>c</b> is the number of consecutive consonants that starts after the <b>i</b>-th character and ends at the <b>j</b>-th character. If we meet the first instance such that <b>c</b> &ge; <b>n</b>, we can conclude that every substring which starts at the <b>i</b>-th character and ends at the <b>k</b>-th character, where <b>k</b> &ge; <b>j</b>, is the desired substring. Then we know that we can add <b>L</b> - <b>j</b> to the answer, and proceed to the next starting character. This algorithm runs in O(<b>L</b><sup>2</sup>) time, which is still not sufficient in solving the large input. But the concept of computing <b>c</b> is the key to solve the problem completely.
</p>
<h2>Further improving</h2>
<p>
Let us extend the definition of <b>c</b> to every character, call it <b>c<sub>i</sub></b>: the number of consecutive consonants that ends at the <b>i</b>-th character. For example, suppose the string is <b>quartz</b>, then <b>c<sub>0</sub></b> = 1, <b>c<sub>2</sub></b> = 0, and <b>c<sub>5</sub></b> = 3. We can use similar approach mentioned in the last section to compute every <b>c<sub>i</sub></b> in O(<b>L</b>) time. Also define a pair (<b>x</b>, <b>y</b>) to be the substring that starts at the <b>x</b>-th character and ends at the <b>y</b>-th character.
</p>
<p>
Knowing from the previous section, if we know that <b>c<sub>i</sub></b> &ge; <b>n</b>, then we know that substrings (<b>i</b> - <b>c<sub>i</sub></b> + <b>p</b>, <b>i</b> + <b>q</b>), where 1 &le; <b>p</b> &le; <b>c<sub>i</sub></b> - <b>n</b> + 1 and 0 &le; <b>q</b> &le; <b>L</b> - <b>i</b> - 1, are the desired substrings. It implies that there are (<b>c<sub>i</sub></b> - <b>n</b> + 1) &times; (<b>L</b> - <b>i</b>) substrings. If you proceed like this, you missed some substrings. Consider the string <b>axb</b> with <b>n</b> = 1. We see that <b>c<sub>1</sub></b> = 1 but we only count 2 substrings, namely <b>x</b> and <b>xb</b>. We miss the <b>prefix</b> options, namely <b>ax</b> and <b>axb</b>. It looks like we can consider the substrings (<b>p</b>, <b>i</b> + <b>q</b>), where 0 &le; <b>p</b> &le; <b>i</b> - <b>n</b> + 1 and 0 &le; <b>q</b> &le; <b>L</b> - <b>i</b> - 1. Unfortunately, in this case we may count certain substrings multiple times. Consider the string <b>xaxb</b> with <b>n</b> = 1, where we count <b>xax</b> and <b>xaxb</b> twice since <b>c<sub>0</sub></b> = <b>c<sub>2</sub></b> = 1.
</p>
<p>
To correctly count the substrings, we need to choose the appropriate range of <b>p</b>. In fact, we just need one more value: the last <b>j</b> &lt; <b>i</b> such that <b>c<sub>j</sub></b> &ge; <b>n</b>. Let <b>r</b> = <b>j</b> - <b>n</b> + 2 if there is such <b>j</b>, or <b>r</b> = 0 otherwise. Then we have the right set of substrings (<b>p</b>, <b>i</b> + <b>q</b>), where <b>r</b> &le; <b>p</b> &le; <b>i</b> - <b>n</b> + 1 and 0 &le; <b>q</b> &le; <b>L</b> - <b>i</b> - 1. In fact, <b>r</b> means the longest possible prefix so that (<b>r</b>, <b>i</b> - <b>n</b>) contains at most <b>n</b> - 1 consecutive consonants and therefore we avoid repeated counting. Hence for each <b>c<sub>i</sub></b> &ge; <b>n</b> we count (<b>i</b> - <b>n</b> - <b>r</b> + 2) &times; (<b>L</b> - <b>i</b>). Summing up we have the answer. <b>r</b> is updated whenever we see that <b>c<sub>i</sub></b> &ge; <b>n</b> before iterating the next position. Therefore it takes constant time to update the value. Overall the running time is O(<b>L</b>), which is enough to solve the large input.
</p>
<p>
Despite the complications, the algorithm is extremely simple. The following is a sample solution:
<pre>
def Solve(s, n):
  L = len(s)
  cnt, r, c = 0, 0, 0
  for i in range(L):
    c = c + 1 if s[i] not in "aeiou" else 0
    if c &gt;= n:
      cnt += (i - n - r + 2) * (L - i)
      r = i - n + 2
  return cnt
</pre>
</p>

  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>



    </div>
  </body>
</html>
