
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2008 - APAC Semifinal</h3><h1>Analysis: Apocalypse Soon</h1><p>
  This problem is a sheep in wolf's clothing. However, it must have been very
  convincing wolf's clothing! Fewer competitors solved it than any other
  problem, despite the simplicity of the actual solution. Since this was an
  onsite round, they were all experienced competitors; in some sense, that
  worked against them.
</p><p>
  Why does the problem seem so hard? To a practiced eye, it has all the
  trappings of a horrible exponential search. You have 5 actions to choose from
  on each day, and the results of those actions don't tend to overlap, leading
  to an exponential number of possible states. Furthermore, even the subtlest
  change in a nation's strength can drastically affect the final outcome, so at
  each step the entire state of the world matters. This makes a Dynamic
  Programming-based solution look unlikely. And due to the chaotic nature of the
  rules, there's unlikely to be a greedy strategy that works in all cases.
</p><p>
  So a horrible exponential search seems essential. On a 50x50 grid of numbers
  between 0 and 1000, this is clearly intractable! Give up and go home. No,
  wait... it's supposed to be solvable somehow, right? How could that be?
</p><p>
  Well, if you try a few cases by hand, you'll soon realize why: everyone ends
  up killing their neighbors really, really quickly. A random map tends to
  stabilize (no living neighbors) in only 4-6 days. It's actually very difficult
  to come up with a case that takes longer. The more you try, the more you'll
  realize just how difficult it is; the army sizes required grow exponentially,
  and the tighter you pack them the sooner they all die. The map size doesn't
  turn out to matter much - it's the army size bound of 1000 that really sets
  the cap on how long you'll need to search.
</p><p>
  What exactly is this cap? That's a really tough question. For instance, if
  army sizes are unbounded, there <i>is</i> no small limit. Here's a simple
  (2<i>n</i>-2)x2 case that takes <i>n</i> days to stabilize:<br>
  1 2 4 8 ... 2<sup>2<i>n</i>-3</sup><br>
  1 2 4 8 ... 2<sup>2<i>n</i>-3</sup>
</p><p>
  However, the army sizes <i>must</i> grow exponentially relative to the number
  of days. Here's a simple proof: on day <i>n</i>, let <i>S<sub>n</sub></i> be
  the strength of the strongest nation that still has living neighbors. Let
  <i>N</i> be any nation with strength &ge; <i>S<sub>n</sub></i>/2.
  Suppose that after 8 days <i>N</i> still has strength &ge;
  <i>S<sub>n</sub></i>/2. Then it must have killed all its neighbors, since
  none had strength &ge; <i>S<sub>n</sub></i> (that is, any neighbor would die
  after at most 2 attacks). So every such <i>N</i> either ends up isolated or
  weaker than <i>S<sub>n</sub></i>/2 after 8 days. Thus,
  <i>S<sub>n+8</sub></i> &le; <i>S<sub>n</sub></i>/2. This puts a strict bound
  of 8(log<sub>2</sub><i>S<sub>n</sub></i>+1) more days before all nations are
  dead or isolated.
</p><p>
  Unfortunately, for army sizes of 1000 this bound of 80 days still isn't very
  helpful. The bound can be improved with tighter reasoning, but due to the
  compact, constrained nature of the grid, the "true" bound is probably much
  smaller - around 9-10 days! However, we don't know how to prove a bound
  anywhere near this. If you can think of a way, let us know! :)
</p><p>
  The worst test case in our data had an answer of "9 day(s)". So as it turns
  out, even a straight brute force solution (on the worst-case order of
  50x50x5<sup>9</sup>) would suffice to solve it. Adding simple pruning
  heuristics and memoization can potentially also help, but isn't necessary.
</p><p>
  Incidentally, one potential coding error you could make is to assume that
  effects can only propagate at one grid square per day. The "speed of light"
  (as it's known in cellular automata) is actually <i>two</i> grid squares per
  day, because if an army's neighbor changes, it may choose to attack its
  opposite neighbor instead. In the "9 day(s)" test case, there are nations 13
  squares away from yours that end up affecting the answer. So if you tried to
  speed up your solution by considering only the local region around your
  nation, you'd have to be careful not to make it <i>too</i> local.
</p><p>
  In the end, all it took to get this problem was bravery (or foolishness). If
  you code it properly and try it, it works! It's just a question of how well
  you can convince yourself that the simple solution has a hope of working. You
  certainly wouldn't want to download the Large dataset and <i>then</i> realize
  your solution was too slow...
</p>


  <div class="test-data-download-wrapper">
    <div class="test-data-download-header">
      <div class="test-data-download-header-text">Test Data</div>
      <div class="test-data-download-header-download-button">
        <a href="test_data.zip" target="_blank">
          <i class="material-icons grey">save_alt</i>
        </a>
      </div>
    </div>
    <div class="test-data-download-content">
      <div class="test-data-download-warning">
        <span class="material-icons" style="color: grey; vertical-align: middle;">info</span>
        <span style="vertical-align: middle;">We recommend that you practice debugging solutions without looking at the test data.</span>
      </div>
    </div>
  </div>



    </div>
  </body>
</html>
