
<html>
  <head>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://www.gstatic.com/external_hosted/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"></script>
    <script>
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$$$','$$$'] ],
          displayMath: [ ['$$$$','$$$$'] ],
          skipTags: ["script","noscript","style","textarea","pre"],  // allow <code>.
          processEscapes: true
        },
        showProcessingMessages: false,
        messageStyle: "none",
        "HTML-CSS": { scale: 90, fonts: ["TeX"] }
      });
      MathJax.Ajax.loadComplete('https://codingcompetitions.withgoogle.com/static/mathjax-config.js');
      </script>
    <style>
.problem-io-wrapper-new .sampleio-wrapper {
  display: flex;
  flex-direction: row;
  align-items: stretch;
  justify-content: flex-start;
  margin-top: 1rem;
  padding-left: 12.5px;
  padding-right: 12.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-input {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: -12.5px;
  margin-right: 12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-output {
  display: flex;
  flex-direction: column;
  flex: 1 1 0px;
  margin-left: 12.5px;
  margin-right: -12.5px;
  max-width: 50%;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-text {
  flex: 1;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-download-button {
  display: none;
  cursor: pointer;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button {
  display: none;
  cursor: pointer;
  position: relative;
  margin-left: 5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup {
  visibility: hidden;
  width: 100px;
  background-color: #999;
  color: #fff;
  text-align: center;
  border-radius: 3px;
  padding: 4px 0;
  position: absolute;
  z-index: 1;
  top: 125%;
  left: 50%;
  margin-left: -50px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup::before {
  content: "";
  position: absolute;
  bottom: 100%;
  left: 50%;
  margin-left: -5px;
  border-width: 5px;
  border-style: solid;
  border-color: transparent transparent #999 transparent;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button .sample-header-copy-popup-shown {
  visibility: visible;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-header .sample-header-copy-button-hidden {
  display: none;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content {
  display: flex;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 0px 9.5px;
}
.problem-io-wrapper-new .sampleio-wrapper .sample-content .sample-content-text {
  flex-grow: 1;
  margin: 0px;
  overflow-x: auto;
  padding-bottom: 9.5px;
  line-height: normal;
  white-space: pre-wrap;
}
.test-data-download-wrapper {
  display: none;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  width: fit-content;
  max-width: 600px;
  margin-top: 1rem;
}
.test-data-download-wrapper .test-data-download-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-text {
  flex: 1;
}
.test-data-download-wrapper .test-data-download-header .test-data-download-header-download-button {
  display: none;
  cursor: pointer;
}
.test-data-download-wrapper .test-data-download-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #f5f5f5;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper {
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-start;
  max-width: 600px;
  margin-top: 1rem;
}
.sample-interaction-wrapper .sample-interaction-header {
  display: flex;
  flex-direction: row;
  border-left: 1px solid #ccc;
  border-right: 1px solid #ccc;
  border-top: 1px solid #ccc;
  border-radius: 4px 4px 0px 0px;
  padding: 9.5px 9.5px 7px 9.5px;
  font-family: 'Google Sans';
  font-size: 1.2rem;
  font-weight: 300;
}
.sample-interaction-wrapper .sample-interaction-header .sample-interaction-text {
  flex: 1;
}
.sample-interaction-wrapper .sample-interaction-content {
  display: flex;
  flex-direction: column;
  flex-grow: 1;
  border: 1px solid #ccc;
  border-radius: 0px 0px 4px 4px;
  background-color: #e6e6e6;
  padding: 9.5px 9.5px 9.5px 9.5px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-judge-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: left;
  flex-grow: 1;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-solution-labels .sample-interaction-solution-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: right;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper {
  display: flex;
  flex-direction: row;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-output-wrapper .sample-interaction-judge-output-box .sample-interaction-judge-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper {
  display: flex;
  flex-direction: row-reverse;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box {
  text-align: start;
  background: #f5f5f5;
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 4px 8px;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-output-wrapper .sample-interaction-solution-output-box .sample-interaction-solution-output-test {
  margin: 0;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-judge-note {
  font-style: italic;
  color: #4e4e4e;
  margin-right: 20%;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-solution-note {
  font-style: italic;
  color: #4e4e4e;
  margin-left: 20%;
  text-align: end;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-section-label {
  font-weight: bold;
  color: #4e4e4e;
  text-align: center;
}
.sample-interaction-wrapper .sample-interaction-content .sample-interaction-block-spacer {
  height: 9.5px;
}
    </style>
  </head>
  <body>
    <div>
<h3>Code Jam 2022 - World Finals</h3><h1>Goose, Goose, Ducks?</h1><h3>Problem</h3>

<p>
The first international Geese conference just wrapped up, and even though it should have been a
happy occasion, it was bittersweet. The organizers found a paper with detailed plans of a duck
infiltration. Now, they are trying to identify the infiltrating group from among the attendees.
</p><p>
The document that they found contained a list of $$$\mathbf{M}$$$ triples of integers
$$$(\mathbf{X_i}, \mathbf{Y_i}, \mathbf{C_i})$$$ meaning the ducks would meet exactly $$$\mathbf{C_i}$$$ seconds after the
start of the conference at point $$$(\mathbf{X_i}, \mathbf{Y_i})$$$, which is $$$\mathbf{X_i}$$$ meters east and
$$$\mathbf{Y_i}$$$ meters north of the center of the conference floor.
Each goose may or may not have been at those specific points at
those specific times, but every duck certainly was.
</p><p>
Both ducks and geese walk at a maximum speed of one meter per second,
which means an attendee that is at point $$$(x, y)$$$ at time
$$$t$$$ can reach any point of the form $$$(x + \Delta_{x}, y + \Delta_{y})$$$
by time $$$t + \Delta_{t}$$$ as long as
$$${\Delta_{x}}^2 + {\Delta_{y}}^2 \le {\Delta_{t}}^2$$$.
Each attendee's position at time $$$0$$$ can be any point, independently of the other attendees.
</p><p align="center">
  <img src="img/goose_goose_ducks.png" alt="A picture of two geese and one duck." style="border: 1px solid black"/>
</p><p>
After the discovery, the group held a questioning session to try to identify the ducks.
During that session, attendees issued a series of statements, one at a time.
The $$$j$$$-th of those, in the order they were issued, was made by attendee $$$\mathbf{A_j}$$$,
claiming that both they and attendee $$$\mathbf{B_j}$$$
were at point $$$(\mathbf{U_j}, \mathbf{V_j})$$$ exactly $$$\mathbf{D_j}$$$ seconds after the start of the conference.
Points in statements may or may not be points where duck meetings happened.
</p>
<p>
  Statements from geese are always true, but ducks may lie.
  Moreover, ducks know which attendees are ducks and which are geese. To avoid getting caught
  easily, ducks only make statements that are consistent with all statements previously made
  by geese. Note that statements made by geese are consistent
  with all ducks being at all duck meetings.
</p><p>
  It may not be possible to determine all the ducks with the information provided.
  However, knowing the minimum number of ducks
  will at least provide a lower bound on the level of duck activity. Note that there was at least
  one duck. Find this minimum number of ducks.
</p>
<p>
Formally, a <i>hypothesis</i> $$$H$$$ is a partition of all attendees into a set of ducks
(named $$$H$$$-ducks) and geese (named $$$H$$$-geese).
$$$H$$$ is consistent with a set of statements $$$S$$$
if there exists a path for each attendee moving at most one meter per second
such that:
</p>
<ul>
  <li>all $$$H$$$-ducks were at all duck meetings and</li>
  <li>for each statement in $$$S$$$ claiming that $$$A$$$ saw $$$B$$$ at point $$$P$$$ at time $$$T$$$,
    both $$$A$$$ and $$$B$$$&NoBreak;'s paths went through point $$$P$$$ at time $$$T$$$.</li>
</ul>
<p>
A hypothesis $$$H$$$ is <i>feasible</i> under a set of statements $$$S$$$ if:
</p>
<ul>
  <li>$$$H$$$-ducks is not empty <i>(i.e., there was at least one duck)</i>,</li>
  <li>the subset of all statements from $$$S$$$ made by members of $$$H$$$-geese is consistent with $$$H$$$ <i>(i.e., statements from geese are always true), and</i></li>
  <li>for each statement $$$s \in S$$$ made by a member of $$$H$$$-ducks, if $$$P \subseteq S$$$ is the subset
    of statements made by members of $$$H$$$-geese issued before $$$s$$$, there exists a hypothesis $$$H'$$$
    (which may or may not be equal to $$$H$$$) such that $$$\{ s \} \cup P$$$ is consistent
    with $$$H'$$$ <i>(i.e., ducks do not contradict previous statements made by geese).</i></li>
</ul>
<p>
Notice that the hypotheses $$$H$$$ such that $$$H$$$-ducks contains all attendees is always feasible.
</p><p>
Find the minimum size of $$$H$$$-ducks over all feasible hypotheses $$$H$$$.
</p>

<h3>Input</h3>
<p>
The first line of the input gives the number of test cases, $$$\mathbf{T}$$$. $$$\mathbf{T}$$$ test cases follow.
Each test case starts with a line containing three integers, $$$\mathbf{N}$$$, $$$\mathbf{M}$$$, and $$$\mathbf{S}$$$, representing
the numbers of attendees, duck meetings, and statements, respectively.
The next $$$\mathbf{M}$$$ lines each describe a different duck meeting with
three integers $$$\mathbf{X_i}$$$, $$$\mathbf{Y_i}$$$, and $$$\mathbf{C_i}$$$, representing that there was a meeting at point
$$$(\mathbf{X_i}, \mathbf{Y_i})$$$, held exactly $$$\mathbf{C_i}$$$ seconds after the start of the conference. Then, the last
$$$\mathbf{S}$$$ lines of a test case each describe a statement. The $$$j$$$-th of these lines describes
the $$$j$$$-th issued statement with five integers $$$\mathbf{A_j}$$$, $$$\mathbf{B_j}$$$, $$$\mathbf{U_j}$$$, $$$\mathbf{V_j}$$$, and $$$\mathbf{D_j}$$$,
representing that attendee $$$\mathbf{A_j}$$$ stated that they and attendee $$$\mathbf{B_j}$$$ were both at point
$$$(\mathbf{U_j}, \mathbf{V_j})$$$ exactly $$$\mathbf{D_j}$$$ seconds after the start of the conference.
</p>

<h3>Output</h3>
<p>
For each test case, output one line containing <code>Case #$$$x$$$: $$$y$$$</code>,
where $$$x$$$ is the test case number (starting from 1) and $$$y$$$ is the minimum number of ducks
that might have infiltrated the conference.
</p>

<h3>Limits</h3>
<p>
Memory limit: 1 GB.<br/>

$$$1 \le \mathbf{T} \le 50$$$.<br/>
$$$-10^9 \le \mathbf{X_i} \le 10^9$$$, for all $$$i$$$.<br/>
$$$-10^9 \le \mathbf{Y_i} \le 10^9$$$, for all $$$i$$$.<br/>
$$$1 \le \mathbf{C_i} \le 10^9$$$, for all $$$i$$$.<br/>
$$$\mathbf{C_i} \lt \mathbf{C_{i+1}}$$$, for all $$$i$$$.<br/>
$$$(\mathbf{X_i} - \mathbf{X_{i+1}})^2 + (\mathbf{Y_i} - \mathbf{Y_{i+1}})^2 \le (\mathbf{C_i} - \mathbf{C_{i+1}})^2$$$, for all $$$i$$$.<br/>
$$$1 \le \mathbf{A_j} \le \mathbf{N}$$$, for all $$$j$$$.<br/>
$$$1 \le \mathbf{B_j} \le \mathbf{N}$$$, for all $$$j$$$.<br/>
$$$\mathbf{A_j} \ne \mathbf{B_j}$$$, for all $$$j$$$.<br/>
$$$-10^9 \le \mathbf{U_j} \le 10^9$$$, for all $$$j$$$.<br/>
$$$-10^9 \le \mathbf{V_j} \le 10^9$$$, for all $$$j$$$.<br/>
$$$1 \le \mathbf{D_j} \le 10^9$$$, for all $$$j$$$.<br/>
$$$(\mathbf{A_j}, \mathbf{B_j}, \mathbf{U_j}, \mathbf{V_j}, \mathbf{D_j}) \ne (\mathbf{A_k}, \mathbf{B_k}, \mathbf{U_k}, \mathbf{V_k}, \mathbf{D_k})$$$, for all $$$j \ne k$$$.<br/>
</p>

<h4>Test Set 1 (Visible Verdict)</h4>
<p>
Time limit: 20 seconds.<br/>

$$$2 \le \mathbf{N} \le 50$$$.<br/>
$$$1 \le \mathbf{M} \le 50$$$.<br/>
$$$1 \le \mathbf{S} \le 50$$$.<br/>
</p>

<h4>Test Set 2 (Hidden Verdict)</h4>
<p>
Time limit: 60 seconds.<br/>

  $$$2 \le \mathbf{N} \le 10^5$$$.<br/>
  $$$1 \le \mathbf{M} \le 10^5$$$.<br/>
  $$$1 \le \mathbf{S} \le 10^5$$$.<br/>
</p>


  <h3>Sample</h3>
  <div class="problem-io-wrapper-new">
    <div class="sampleio-wrapper">
      <div class="sample-input">
        <div class="sample-header">
          <div class="sample-header-text">Sample Input</div>
          <div class="sample-header-download-button">
            <a href="goose_goose_ducks_sample_ts1_input.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_input_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_input_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_input_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_input_0">2
2 1 2
1 2 3
1 2 1 1 1
2 1 2 2 2
4 2 4
4 3 10
-4 -3 20
1 3 4 3 11
2 4 0 0 16
3 1 6 3 9
4 2 0 0 16
</pre>
        </div>
      </div>
      <div class="sample-output">
        <div class="sample-header">
          <div class="sample-header-text">Sample Output</div>
          <div class="sample-header-download-button">
            <a href="goose_goose_ducks_sample_ts1_output.txt" target="_blank" aria-label="Download">
              <i class="material-icons grey">save_alt</i>
            </a>
          </div>
          <div class="sample-header-copy-button" onclick="
              const copyText = document.getElementById('sample_output_0').textContent;
              const textArea = document.createElement('textarea');
              textArea.textContent = copyText;
              textArea.style.position = 'absolute';
              textArea.style.left = '-100%';
              document.body.append(textArea);
              textArea.select();
              document.execCommand('copy');
              textArea.remove();
              const copyPopup = document.getElementById('sample_output_copy_popup_0');
              copyPopup.classList.add('sample-header-copy-popup-shown');
              setTimeout(function(){ copyPopup.classList.remove('sample-header-copy-popup-shown'); }, 2000);
          " aria-label="Copy to clipboard">
            <i class="material-icons grey">content_copy</i>
            <span class="sample-header-copy-popup" id="sample_output_copy_popup_0">
              Copied!
            </span>
          </div>
        </div>
        <div class="sample-content">
          <pre class="sample-content-text" id="sample_output_0">Case #1: 1
Case #2: 2
</pre>
        </div>
      </div>
    </div>
  </div>


<p>
  In Sample Case #1, attendee 1 being the only duck is a feasible hypothesis.
</p><p>
  In Sample Case #2, attendees 2 and 4 being the only ducks is a feasible hypothesis.
  Note that there is at least one duck, so all attendees being geese is not feasible.
</p>

    </div>
  </body>
</html>
